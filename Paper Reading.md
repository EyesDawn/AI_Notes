# 1 FAN

## 1.1 ç†è§£
1. FAN == DFT + RevINï¼šFANåœ¨é¢‘åŸŸä¸Šåˆ©ç”¨å‚…é‡Œå¶å˜æ¢å¤„ç†å¹³ç¨³ä¸Žéžå¹³ç¨³æˆåˆ†ï¼Œè€ŒRevINåœ¨æ—¶åŸŸä¸Šåˆ©ç”¨æ ‡å‡†åŒ–å¤„ç†ã€‚

### å…³äºŽX yçš„å½¢çŠ¶

**è®­ç»ƒé›†**ï¼š

- `x_train.shape = (700, 96, 8)` â†’ 700ä¸ªæ ·æœ¬ï¼Œæ¯ä¸ªæ ·æœ¬æ˜¯ **96ä¸ªæ—¶é—´æ­¥** Ã— **8ä¸ªç‰¹å¾**
- `y_train.shape = (700, 192, 8)` â†’ 700ä¸ªæ ‡ç­¾ï¼Œæ¯ä¸ªæ ‡ç­¾æ˜¯ **192ä¸ªæ—¶é—´æ­¥** Ã— **8ä¸ªç‰¹å¾**

PyTorch çš„ `DataLoader` ä¼šå°†æ•°æ®é›†æŒ‰ `batch_size` åˆ†æˆå¤šä¸ªæ‰¹æ¬¡ã€‚æ¯ä¸ªæ‰¹æ¬¡çš„ç»“æž„å¦‚ä¸‹ï¼š

**è®­ç»ƒé›†æ‰¹æ¬¡ (`train_loader`)**:

- **è¾“å…¥ `x_batch`**ï¼š`(batch_size, 96, 8)`
- **æ ‡ç­¾ `y_batch`**ï¼š`(batch_size, 192, 8)`

**æµ‹è¯•é›†æ‰¹æ¬¡ (`test_loader`)**:

- **è¾“å…¥ `x_batch`**ï¼š`(batch_size, 96, 8)`
- **æ ‡ç­¾ `y_batch`**ï¼š`(batch_size, 192, 8)`

Xï¼šè¾“å…¥çš„ tensorï¼Œå½¢çŠ¶æ˜¯ (B, T, N)ï¼ŒB: batch_size (æ‰¹æ¬¡å¤§å°), T: window (*è¾“å…¥åºåˆ—é•¿åº¦*), N: num_features (ç‰¹å¾æ•°é‡)

yï¼štargets, ä¹Ÿæ˜¯ tensor, å½¢çŠ¶æ˜¯ (B, O, N), O: steps(*é¢„æµ‹åºåˆ—é•¿åº¦*)

å®žä¾‹çº§Fourierï¼šå¯¹Xåœ¨æ—¶é—´ç»´åº¦ä¸Šåšå˜æ¢ã€‚æ¯”å¦‚å½¢çŠ¶æ˜¯ (32, 12, 307)çš„Xï¼Œå°±å¯¹æ‰€æœ‰32ä¸ªæ ·æœ¬çš„307ä¸ªç‰¹å¾éƒ½åˆ†åˆ«è¿›è¡Œå˜æ¢ã€‚

å…¨å±€çº§Fourierï¼šä¹ŸXåœ¨æ—¶é—´ç»´åº¦ä¸Šåšå˜æ¢ï¼Œä½†å˜æ¢å®ŒåŽï¼Œåœ¨batchå’Œç‰¹å¾ç»´åº¦ä¸Šå–å¹…å€¼çš„å¹³å‡å€¼ã€‚å¦å¤–ï¼Œtop_kå›ºå®š(TimesNet)ã€‚

### FFT

åœ¨ä½¿ç”¨å‚…é‡Œå¶å˜æ¢ï¼ˆFFTï¼‰å¤„ç†æ—¶é—´åºåˆ—æ—¶ï¼Œè™½ç„¶å˜æ¢åŽçš„å½¢çŠ¶ä¸ŽåŽŸå§‹æ•°æ®ç›¸åŒï¼Œä½†å…¶**ç‰©ç†æ„ä¹‰å·²å®Œå…¨ä¸åŒ**ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£é‡Šï¼š

---

#### 1. FFT çš„è¾“å…¥ä¸Žè¾“å‡º
**(1) è¾“å…¥æ•°æ®**

- å‡è®¾åŽŸå§‹æ•°æ®å½¢çŠ¶ä¸º `(æ ·æœ¬æ•°, é€šé“æ•°, æ—¶é—´æ­¥æ•°)`ï¼Œä¾‹å¦‚ `(1000, 1, 500)`ã€‚
- åœ¨ä»£ç ä¸­ï¼Œå…ˆé€šè¿‡ `transpose(1, 2)` å°†é€šé“å’Œæ—¶é—´ç»´åº¦äº¤æ¢ï¼Œå˜ä¸º `(æ ·æœ¬æ•°, æ—¶é—´æ­¥æ•°, é€šé“æ•°)`ï¼Œå³ `(1000, 500, 1)`ã€‚
  - è¿™æ ·åšçš„ç›®çš„æ˜¯ä¸ºäº†å¯¹æ¯ä¸ªé€šé“ï¼ˆå¦‚ä¼ æ„Ÿå™¨ä¿¡å·ï¼‰ç‹¬ç«‹è¿›è¡Œ FFTã€‚

**(2) FFT çš„è¾“å‡º**

- å¯¹é•¿åº¦ä¸º $N$ çš„æ—¶é—´åºåˆ—è¿›è¡Œ FFTï¼Œç»“æžœæ˜¯ä¸€ä¸ªå¤æ•°æ•°ç»„ï¼ŒåŒ…å« $N$ ä¸ªé¢‘çŽ‡åˆ†é‡ã€‚
  - ä¾‹å¦‚ï¼ŒåŽŸå§‹æ—¶é—´åºåˆ—æœ‰ 500 ä¸ªæ—¶é—´æ­¥ï¼ŒFFT åŽä»ä¸º 500 ä¸ªé¢‘çŽ‡åˆ†é‡ã€‚

> [!NOTE] è§£é‡Š500ä¸ªé¢‘çŽ‡åˆ†é‡
> **å›ºå®šçš„æ˜¯é¢‘çŽ‡åˆ†è¾¨çŽ‡ï¼ˆfrequency resolutionï¼‰**ï¼Œç”±é‡‡æ ·ç‚¹æ•° $N$ å’Œé‡‡æ ·é¢‘çŽ‡ $f_s$ å†³å®šã€‚
> å¯ä»¥æ˜Žç¡®çŸ¥é“å®ƒä»¬å¯¹åº”å“ªäº›å…·ä½“é¢‘çŽ‡ï¼š$f_k = \tfrac{k}{N} f_s$ã€‚
> ä½†åˆ†é‡çš„**å¼ºåº¦ï¼ˆå¹…åº¦/ç›¸ä½ï¼‰ç”±è¾“å…¥æ•°æ®å†³å®š**ã€‚
> æ‰€ä»¥FFTèƒ½å‘Šè¯‰ä½ è¾“å…¥ä¿¡å·åŒ…å«äº†å“ªäº›é¢‘çŽ‡æˆåˆ†ï¼Œä»¥åŠå®ƒä»¬çš„å¼ºåº¦ï¼ˆå¹…å€¼ï¼‰å’Œç›¸ä½ã€‚

- å–ç»å¯¹å€¼åŽï¼Œå¾—åˆ°å¹…åº¦è°±ï¼ˆMagnitude Spectrumï¼‰ï¼Œå½¢çŠ¶ä¸Žè¾“å…¥ä¸€è‡´ã€‚
  - ä¾‹å¦‚ï¼Œè¾“å…¥å½¢çŠ¶ä¸º `(1000, 500, 1)` â†’ FFT åŽå½¢çŠ¶ä»ä¸º `(1000, 500, 1)`ã€‚

**(3) æ¢å¤ç»´åº¦**

- æœ€ç»ˆé€šè¿‡ `transpose(1, 2)` å°†é€šé“å’Œæ—¶é—´ç»´åº¦æ¢å›žï¼Œå½¢çŠ¶æ¢å¤ä¸º `(æ ·æœ¬æ•°, é€šé“æ•°, æ—¶é—´æ­¥æ•°)`ï¼Œå³ `(1000, 1, 500)`ã€‚
  - æ­¤æ—¶ï¼Œæ¯ä¸ªæ—¶é—´æ­¥çš„å€¼è¡¨ç¤ºå¯¹åº”é¢‘çŽ‡çš„å¹…åº¦ï¼ˆè€ŒéžåŽŸå§‹æ—¶åŸŸå€¼ï¼‰ã€‚

---

#### 2. å½¢çŠ¶ä¸å˜çš„åŽŸå› 
**(1) é¢‘çŽ‡åˆ†é‡ä¸Žæ—¶é—´æ­¥ä¸€ä¸€å¯¹åº”**

- FFT çš„æœ¬è´¨æ˜¯å°†æ—¶åŸŸä¿¡å·åˆ†è§£ä¸ºå¤šä¸ªæ­£å¼¦/ä½™å¼¦æ³¢çš„å åŠ ï¼Œæ¯ä¸ªæ—¶é—´æ­¥å¯¹åº”ä¸€ä¸ªé¢‘çŽ‡åˆ†é‡ã€‚
  - ä¾‹å¦‚ï¼Œé•¿åº¦ä¸º 500 çš„æ—¶é—´åºåˆ— â†’ 500 ä¸ªé¢‘çŽ‡åˆ†é‡ã€‚
- å› æ­¤ï¼ŒFFT çš„è¾“å‡ºé•¿åº¦ä¸Žè¾“å…¥é•¿åº¦ç›¸åŒï¼Œå½¢çŠ¶ä¿æŒä¸€è‡´ã€‚

**(2) ä¿ç•™æ—¶é—´åºåˆ—ç»“æž„**

- é€šè¿‡ä¿æŒå½¢çŠ¶ä¸€è‡´ï¼Œå¯ä»¥ç›´æŽ¥å°†é¢‘åŸŸç‰¹å¾ä½œä¸ºæ¨¡åž‹è¾“å…¥ï¼Œæ— éœ€é¢å¤–è°ƒæ•´ç½‘ç»œç»“æž„ã€‚
  - ä¾‹å¦‚ï¼Œå·ç§¯ç¥žç»ç½‘ç»œï¼ˆCNNï¼‰å¯ä»¥åƒå¤„ç†æ—¶åŸŸä¿¡å·ä¸€æ ·å¤„ç†é¢‘åŸŸä¿¡å·ã€‚

**(3) å¤šé€šé“ç‹¬ç«‹å¤„ç†**

- æ¯ä¸ªé€šé“ï¼ˆå¦‚å¤šä¸ªä¼ æ„Ÿå™¨ï¼‰ç‹¬ç«‹è¿›è¡Œ FFTï¼Œå› æ­¤é€šé“ç»´åº¦ä¸å—å½±å“ã€‚

---

#### 3. å…³é”®ä»£ç é€»è¾‘
```python
# 1. è½¬ç½®ä»¥åœ¨æ—¶é—´ç»´åº¦ä¸Šåš FFT
train_X_transposed = train_X.transpose(1, 2)  # (æ ·æœ¬æ•°, æ—¶é—´æ­¥æ•°, é€šé“æ•°)

# 2. FFT å˜æ¢å¹¶å–ç»å¯¹å€¼
train_X_fft = torch.fft.fft(train_X_transposed).abs()  # (æ ·æœ¬æ•°, æ—¶é—´æ­¥æ•°, é€šé“æ•°)

# 3. æ¢å¤é€šé“å’Œæ—¶é—´ç»´åº¦
train_X_fft = train_X_fft.transpose(1, 2)  # (æ ·æœ¬æ•°, é€šé“æ•°, æ—¶é—´æ­¥æ•°)
```



## 1.2 ç–‘é—®

1.  ä¸ºä»€ä¹ˆé‡‡ç”¨MLPæ¥å¤„ç†éžå¹³ç¨³çš„ä¿¡å·ï¼Ÿè€ƒè™‘åˆ°RNNæ•èŽ·æ—¶é—´ä¾èµ–ä¿¡æ¯çš„èƒ½åŠ›æ›´å¼ºï¼Œä¸ºä»€ä¹ˆFANæ²¡æœ‰è€ƒè™‘ç”¨LSTMã€GRUï¼Ÿ
   1.  å®žéªŒç»“æžœæ˜¾ç¤º3å±‚MLPçš„æ•ˆæžœæœ€å¥½ï¼Œå¯èƒ½çš„åŽŸå› æ˜¯â€œä¸»é¢‘çŽ‡ä¿¡å·ä¸ºéª¨å¹²æ¨¡åž‹æä¾›äº†åŸºçº¿ä½ç½®ï¼Œä»Žè€Œå¯¼è‡´æ›´ç¨³å¥çš„é¢„æµ‹â€
   2.  åœ¨æ‰€æœ‰åŸºå‡†æµ‹è¯•ä¸­ï¼Œä¸»é¢‘çŽ‡åˆ†é‡çš„å˜åŒ–å°äºŽæ®‹å·®çš„å˜åŒ–ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€ä¸ªç®€å•çš„MLPè¶³å¤Ÿæœ‰æ•ˆåœ°æ•æ‰åˆ°ä¸»è¦é¢‘çŽ‡å˜åŒ–çš„åŽŸå› ã€‚ï¼ˆå®ƒçš„åç§»ç›¸å¯¹è¾ƒå°ï¼‰

2.  ä¸ºä»€ä¹ˆæ•°æ®ä¸­çš„ä½Žé¢‘éƒ¨åˆ†è¡¨ç¤ºè¶‹åŠ¿ï¼Œè€Œé«˜é¢‘éƒ¨åˆ†è¡¨ç¤ºå­£èŠ‚æ€§(seasonal)
    1.  **é¢‘è°±è§’åº¦çš„è§£é‡Šï¼š**
         å½“æˆ‘ä»¬å°†ä¸€ä¸ªæ—¶é—´åºåˆ—è¿›è¡Œé¢‘è°±åˆ†æžæ—¶ï¼Œå¯ä»¥çœ‹åˆ°ä¸åŒé¢‘çŽ‡çš„æˆåˆ†åœ¨ä¿¡å·ä¸­æ‰€å æ¯”ä¾‹ã€‚ä½Žé¢‘æˆåˆ†ä»£è¡¨çš„æ˜¯é‚£äº›å‘¨æœŸè¾ƒé•¿ã€ç¼“æ…¢å˜åŒ–çš„éƒ¨åˆ†ï¼ˆè¶‹åŠ¿ï¼‰ï¼Œè€Œé«˜é¢‘æˆåˆ†åˆ™ä»£è¡¨å‘¨æœŸè¾ƒçŸ­ã€æŒ¯å¹…è¾ƒå¤§çš„å˜åŒ–ï¼ˆå­£èŠ‚æ€§æ³¢åŠ¨ï¼‰ã€‚
    2.  **æ•°æ®æ¨¡åž‹çš„é€‚ç”¨æ€§ï¼š**
         å¦‚æžœä¸€ä¸ªæ•°æ®é›†ä¸­ä¸ä»…æœ‰æ˜¾è‘—çš„ä½Žé¢‘è¶‹åŠ¿ï¼Œè¿˜å­˜åœ¨æ˜Žæ˜¾çš„é«˜é¢‘å­£èŠ‚æ€§æ³¢åŠ¨ï¼Œåˆ™ä¸€ä¸ªèƒ½å¤ŸåŒæ—¶æ•æ‰ä¸¤ç§ä¿¡æ¯çš„æ¨¡åž‹ï¼ˆä¾‹å¦‚æ–‡ä¸­æåˆ°çš„æ–¹æ³•ï¼‰å¯èƒ½ä¼šåœ¨é¢„æµ‹æ€§èƒ½ä¸Šæœ‰æ˜¾è‘—æå‡ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåœ¨é«˜é¢‘å˜åŒ–ï¼ˆå³å­£èŠ‚æ€§å˜åŒ–ï¼‰æ˜Žæ˜¾çš„æ•°æ®é›†ä¸Šï¼Œæ¨¡åž‹è¡¨çŽ°æå‡æ›´ä¸ºæ˜Žæ˜¾ï¼ˆå¦‚æœ€é«˜æå‡è¾¾åˆ°äº† 19.90%ã€18.65% ç­‰ï¼‰ã€‚

# 2 The Rise of Diffusion Models in Time-Series Forecasting

## 2.1 Evaluation Metrics

$$
\mathrm{MSE}(\hat{X}_{tar},X_{tar})=\frac1F\sum_{t=0}^F(x_t-\hat{x}_t)^2\quad\mathrm{MAE}(\hat{X}_{tar},X_{tar})=\frac1F\sum_{t=0}^F|x_t-\hat{x}_t|
$$

$$
\mathrm{CRPS}(\hat{F}_{i,t}^N,x_{i,t})=\int_{\mathbb{R}}\left(\hat{F}_{i,t}^N(z)-\mathbb{I}\{x_{i,t}\leq z\}\right)^2dz
$$

MSEå’ŒMAEå…³æ³¨çš„æ˜¯å¹³å‡è¯¯å·®ï¼Œæ˜¯**ä¸€ä¸ªç‚¹é¢„æµ‹å€¼**å’Œå®žé™…å€¼ä¹‹é—´çš„è·ç¦»ï¼›è€ŒCRPSè¯„ä¼°**æ¦‚çŽ‡é¢„æµ‹çš„å¥½å** ï¼Œæ˜¯é¢„æµ‹çš„åˆ†å¸ƒä¸Žé˜¶è·ƒåˆ†å¸ƒï¼ˆå®žé™…ç»“æžœï¼‰ä¹‹é—´çš„å·®è·é¢ç§¯ã€‚

## 2.2 Diffusion Models

**æ‰©æ•£æ¨¡åž‹é€šè¿‡â€œåŠ å™ª-åŽ»å™ªâ€çš„è¿‡ç¨‹è®­ç»ƒç”Ÿæˆå™¨æ¨¡åž‹**ï¼Œé€šè¿‡ KL æ•£åº¦æˆ–å™ªå£°é¢„æµ‹æŸå¤±æ¥è®­ç»ƒç¥žç»ç½‘ç»œï¼Œæœ€ç»ˆå®žçŽ°â€œä»Žå™ªå£°ä¸­ç”Ÿæˆé«˜è´¨é‡æ•°æ®â€çš„ç›®æ ‡ã€‚

### 2.2.1 Denoising Diffusion Probabilistic Model (DDPM)

#### ðŸ“ˆ æ­£å‘è¿‡ç¨‹ï¼ˆForward Processï¼‰å…¬å¼ (6)-(8)

##### 1. å…¬å¼ (6)ï¼šåŠ å™ªå£°çš„é©¬å°”å¯å¤«è¿‡ç¨‹

$$
q(x^{1:K}|x^0) = \prod_{k=1}^{K} q(x^k | x^{k-1})\quad \text{ä¸” } q(x^k | x^{k-1}) = \mathcal{N}(x^k; \sqrt{1 - \beta_k}x^{k-1}, \beta_k I)
$$

è¡¨ç¤ºï¼šæ¯ä¸€æ­¥ç”¨ä¸€ä¸ªé«˜æ–¯å™ªå£°æ‰°åŠ¨å‰ä¸€æ­¥çš„ç»“æžœã€‚

- $\beta_k$ï¼šç¬¬ k æ­¥çš„å™ªå£°å¼ºåº¦
- $\mathcal{N}(\cdot, \cdot)$ï¼šé«˜æ–¯åˆ†å¸ƒ

------

##### 2. å…¬å¼ (7)-(8)ï¼šä¸€æ­¥è®¡ç®—ä»»æ„æ—¶åˆ»çš„ç»“æžœ

ä½ å¯ä»¥ä»Žåˆå§‹æ•°æ® $x^0$ ä¸€æ­¥è·³åˆ°ä»»æ„æ—¶é—´æ­¥ $x^k$ï¼Œä¸éœ€è¦æŒ‰æ­¥éª¤æ¨¡æ‹Ÿï¼š
$$
x^k = \sqrt{\alpha_k} x^0 + \sqrt{1 - \alpha_k} \cdot \epsilon,\quad \epsilon \sim \mathcal{N}(0, I)
$$

- è¿™é‡Œ $\alpha_k = \prod_{i=1}^{k} (1 - \beta_i)$
- å®žé™…æ„æ€ï¼šå™ªå£°æˆåˆ†è¶Šæ¥è¶Šå¤šï¼Œ$x^k$ è¶Šæ¥è¶Šâ€œæ¨¡ç³Šâ€

------

#### ðŸ” åå‘è¿‡ç¨‹ï¼ˆReverse Processï¼‰å…¬å¼ (9)-(10)

åå‘è¿‡ç¨‹æ˜¯æ¨¡åž‹å­¦ä¹ çš„ç›®æ ‡ï¼šä»Žçº¯å™ªå£°ä¸€æ­¥æ­¥â€œè¿˜åŽŸâ€å‡ºå¹²å‡€æ•°æ®ã€‚
$$
p_\theta(x^{0:K}) = p(x^K) \prod_{k=1}^K p_\theta(x^{k-1}|x^k)
$$
å…¶ä¸­ï¼š

- $x^{0:K}$: è¡¨ç¤ºåºåˆ— ($x^0, x^1, ..., x^K$), å…¶ä¸­:
    - $x^0$: åŽŸå§‹æ•°æ® (å¦‚å›¾åƒã€éŸ³é¢‘ç­‰)ã€‚
    - $x^k$ ($k = 1, ..., K$): æ·»åŠ å™ªå£°åŽçš„ä¸­é—´çŠ¶æ€, $x^K$ æ˜¯å®Œå…¨çš„çº¯å™ªå£°ã€‚
- $p(x^K)$: å™ªå£°çš„å…ˆéªŒåˆ†å¸ƒ, é€šå¸¸æ˜¯æ ‡å‡†é«˜æ–¯åˆ†å¸ƒ $\mathcal{N}(0, I)$ã€‚å®ƒæè¿°æ‰©æ•£è¿‡ç¨‹ç»“æŸæ—¶çš„å™ªå£°çŠ¶æ€ã€‚
- $p_\theta(x^{k-1}|x^k)$: å‚æ•°åŒ–çš„é€†å‘è½¬ç§»æ¦‚çŽ‡ã€‚ç»™å®šå½“å‰å™ªå£°çŠ¶æ€ $x^k$, å®ƒé¢„æµ‹å‰ä¸€æ­¥çš„â€œåŽ»å™ªâ€çŠ¶æ€ $x^{k-1}$ã€‚è¿™æ˜¯ç”±ç¥žç»ç½‘ç»œå‚æ•°åŒ–çš„, å…¶ä¸­ $\theta$ æ˜¯æ¨¡åž‹çš„å¯å­¦ä¹ å‚æ•°ã€‚
- $\prod_{k=1}^{K}$: è¡¨ç¤ºé€†å‘è¿‡ç¨‹æ˜¯ä¸€ä¸ªé©¬å°”å¯å¤«é“¾, æ¯ä¸€æ­¥ä»…ä¾èµ–å‰ä¸€æ­¥çš„çŠ¶æ€ã€‚

- æ¯ä¸€æ­¥ï¼š$p_\theta(x^{k-1}|x^k) = \mathcal{N}(x^{k-1}; \mu_\theta(x^k, k), \sigma_k^2 I)$

$\mu_\theta(x^k, k)$ æ˜¯é€šè¿‡ç¥žç»ç½‘ç»œé¢„æµ‹çš„å‡å€¼ï¼ˆä»£è¡¨æˆ‘ä»¬â€œåŽ»å™ªâ€åŽçš„çŒœæµ‹ï¼‰

------

##### å…¬å¼ (10)ï¼šå¯é€‰æ‹©çš„æ–¹å·®

$$
\sigma_k^2 = 
\begin{cases}
\frac{\beta_k}{\hat{\beta}_k}, & \text{å¦‚æžœ } x^0 \sim \mathcal{N}(0, I) \\
\frac{1 - \alpha_{k-1}}{1 - \alpha_k}, & \text{å¦‚æžœ } x^0 æ˜¯ç¡®å®šçš„
\end{cases}
$$

#### ðŸ§ è®­ç»ƒç›®æ ‡ï¼ˆå…¬å¼ 11-15ï¼‰

##### 1. KLæ•£åº¦æŸå¤±(11)

æˆ‘ä»¬å¸Œæœ›å­¦ä¹ çš„åˆ†å¸ƒ $p_\theta(x^{k-1}|x^k)$ èƒ½å¤Ÿå°½é‡æŽ¥è¿‘çœŸå®žçš„åŽéªŒåˆ†å¸ƒ $q(x^{k-1}|x^k)$

##### 2. é‡å‚æ•°åŒ–ç›®æ ‡(12)-(15)

é€šè¿‡æŽ¨å¯¼ï¼Œå¯ä»¥æŠŠæŸå¤±å˜æˆå¦‚ä¸‹å½¢å¼ï¼š
$$
\mathcal{L}_k = \frac{1}{2\sigma_k^2} \|\tilde{\mu}_k(x^k, x^0) - \mu_\theta(x^k, k)\|^2
$$

- $\tilde{\mu}_k$ æ˜¯åŸºäºŽ $x^0$ å’Œ $x^k$ è®¡ç®—çš„çœŸå®žåŽéªŒå‡å€¼
- $\mu_\theta$ æ˜¯æ¨¡åž‹é¢„æµ‹çš„åŽ»å™ªå‡å€¼

ç›´è§‚æ¥è¯´ï¼šæ¨¡åž‹å­¦ä¹ â€œå¦‚ä½•ä»Žå™ªå£°å›¾åƒçŒœå‡ºåŽŸå›¾â€

Ho ç­‰äººæå‡ºï¼Œç›´æŽ¥é¢„æµ‹å™ªå£°ï¼ˆè€Œä¸æ˜¯å›¾åƒï¼‰æ•ˆæžœæ›´å¥½ï¼š
$$
\mu_\theta(\epsilon_\theta) = \frac{1}{\sqrt{1 - \hat{\beta}_k}} \left( x^k - \frac{\beta_k}{\sqrt{1 - \alpha_k}} \epsilon_\theta(x^k, k) \right)
$$
æœ€ç»ˆæŸå¤±å°±æ˜¯é¢„æµ‹å™ªå£°å’ŒçœŸå®žå™ªå£°çš„å·®è·ï¼š
$$
\mathcal{L}_\epsilon = \mathbb{E}_{x,k,\epsilon} \left[ \|\epsilon - \epsilon_\theta(x^k, k)\|^2 \right]
$$

### 2.2.2 Score-based generative modeling through SDE

æ‰©æ•£æ¨¡åž‹çš„ç›®æ ‡æ˜¯ï¼šä»Žéšæœºå™ªå£°ä¸­ä¸€æ­¥æ­¥â€œåæŽ¨å‡ºâ€çœŸå®žæ•°æ®ã€‚ä¸ºäº†è®©è¿™ä¸ªè¿‡ç¨‹æ›´ç²¾ç»†å’Œçµæ´»ï¼Œæœ‰äººæå‡ºå¯ä»¥ç”¨ **è¿žç»­æ—¶é—´çš„æ•°å­¦æ¨¡åž‹ï¼šéšæœºå¾®åˆ†æ–¹ç¨‹ï¼ˆSDEï¼‰** æ¥æè¿°è¿™ä¸ªâ€œåŠ å™ªå£°â€å’Œâ€œåŽ»å™ªå£°â€çš„è¿‡ç¨‹ã€‚

#### ðŸ“˜ å…¬å¼ (18)ï¼šæ­£å‘æ‰©æ•£è¿‡ç¨‹ SDE

$$
dx = f(x, k)\,dk + g(k)\,d\mathbf{w}
$$

è¿™ä¸ªå…¬å¼æè¿°çš„æ˜¯ï¼š**ä½ æ€Žä¹ˆå¾€çœŸå®žæ•°æ®é‡Œâ€œæ³¨å…¥å™ªå£°â€**ã€‚

- $x$ï¼šå½“å‰çš„æ•°æ®ï¼ˆå›¾åƒã€éŸ³é¢‘ç­‰ï¼‰ã€‚$dx$ æè¿°çš„æ˜¯æ•°æ®çŠ¶æ€åœ¨ä¸€ä¸ªå°æ—¶é—´æ®µå†…çš„å˜åŒ–ã€‚
- $k$ï¼šå½“å‰çš„â€œæ—¶é—´æ­¥â€ï¼Œåœ¨ [0, K] ä¹‹é—´ï¼ˆä»Žå¹²å‡€åˆ°å…¨å™ªå£°ï¼‰ã€‚$dk$åˆ™æ˜¯æ—¶é—´æ­¥çš„å˜åŒ–é‡ã€‚
- $f(x,k)\,dk$ï¼šè¡¨ç¤ºâ€œè‡ªç„¶æ¼”åŒ–â€ï¼ˆå¯ä»¥æ˜¯è®©å›¾åƒé€æ¸æ¨¡ç³Šçš„è¶‹åŠ¿ï¼‰
- $g(k)\,d\mathbf{w}$ï¼šè¡¨ç¤ºåŠ å…¥çš„éšæœºå™ªå£°ï¼Œå…¶ä¸­ **$g(k)$** æ˜¯ä¸Žå½“å‰æ—¶é—´æ­¥ $k$ ç›¸å…³çš„å™ªå£°å¼ºåº¦ï¼Œ**$d\mathbf{w}$** æ˜¯ä¸€ä¸ªæ ‡å‡†å¸ƒæœ—è¿åŠ¨å¢žé‡ï¼ˆéšæœºå˜åŒ–çš„éƒ¨åˆ†ï¼‰ã€‚

è¿™å°±åƒï¼šä½ æ¯ç§’éƒ½å¾€å›¾åƒé‡ŒåŠ å…¥ä¸€äº›æ¨¡ç³Šã€æŠ–åŠ¨ã€éšæœºæ‰°åŠ¨ã€‚

------

#### ðŸ” å…¬å¼ (19)ï¼šåå‘åŽ»å™ªè¿‡ç¨‹ SDE

$$
dx = \left[f(x, k) - g(k)^2 \nabla_x \log p_k(x) \right]\,dk + g(k)\,d\bar{\mathbf{w}}
$$

è¿™æ˜¯â€œåè¿‡æ¥â€çš„è¿‡ç¨‹ â€”â€” **ä»Žå™ªå£°å˜æˆå›¾åƒ**

- $\nabla_x \log p_k(x)$ï¼šè¿™ä¸ªæ˜¯å…³é”®ï¼Œå®ƒå«åš **score**ï¼Œè¡¨ç¤ºâ€œåœ¨å½“å‰å›¾åƒé™„è¿‘ï¼Œä»€ä¹ˆæ–¹å‘æ›´å¯èƒ½æ˜¯å¹²å‡€å›¾åƒâ€
- **$g(k)\,d\bar{\mathbf{w}}$**ï¼šå’Œæ­£å‘æ‰©æ•£è¿‡ç¨‹ä¸­çš„å™ªå£°é¡¹ç±»ä¼¼ï¼Œè¡¨ç¤ºå™ªå£°åœ¨åå‘åŽ»å™ªè¿‡ç¨‹ä¸­åŠ å…¥çš„éƒ¨åˆ†
- æ•´ä¸ªå¼å­æœ¬è´¨æ˜¯ï¼šâ€œæ²¿ç€å¾—åˆ†çš„æ–¹å‘â€ä¸€æ­¥æ­¥åŽ»é™¤å™ªå£°

------

#### ðŸ§  ä»€ä¹ˆæ˜¯ scoreï¼ˆ$\nabla_x \log p(x)$ï¼‰ï¼Ÿ

å®ƒè¡¨ç¤º **åœ¨å½“å‰å›¾åƒé™„è¿‘çš„æ¢¯åº¦æ–¹å‘**ï¼Œå¯ä»¥çœ‹ä½œæ˜¯ **â€œæŒ‡å‘çœŸå®žæ•°æ®çš„æ–¹å‘â€**ã€‚

åœ¨ä¸€ä¸ªå›¾åƒåŠ äº†å™ªå£°åŽï¼Œæˆ‘ä»¬æƒ³çŸ¥é“ï¼šâ€œå¾€å“ªä¸ªæ–¹å‘èµ°ï¼Œèƒ½è®©å®ƒçœ‹èµ·æ¥æ›´åƒä¸€ä¸ªçœŸå®žå›¾åƒï¼Ÿâ€
 è¿™å°±æ˜¯ score å‡½æ•°å‘Šè¯‰ä½ çš„ä¸œè¥¿ã€‚

------

#### ðŸ§ª å…¬å¼ (20)ï¼šè®­ç»ƒç›®æ ‡ï¼ˆscore matchingï¼‰

$$
\mathcal{L}_{s_\theta} = \mathbb{E} \left[\| \nabla_x \log p_k(x) - s_\theta(x, k) \|^2 \right]
$$

ä½ è®­ç»ƒä¸€ä¸ªç¥žç»ç½‘ç»œ $s_\theta(x, k)$ï¼Œè®©å®ƒå­¦ä¼šâ€œé¢„æµ‹ scoreâ€ï¼Œä¹Ÿå°±æ˜¯é¢„æµ‹â€œæˆ‘è¯¥å¾€å“ªä¸ªæ–¹å‘åŽ»æŽ‰å™ªå£°â€ã€‚

è¿™ç›¸å½“äºŽè®­ç»ƒä¸€ä¸ªâ€œæ–¹å‘æŒ‡å¼•å™¨â€ã€‚

------

#### ðŸ§­ ODE å’Œ â€œæ¦‚çŽ‡æµâ€ æ˜¯ä»€ä¹ˆï¼Ÿ

åœ¨åŽ»å™ªçš„è¿‡ç¨‹ä¸­ï¼ŒåŽŸæ¥çš„å…¬å¼æœ‰**éšæœºæ‰°åŠ¨é¡¹**ï¼Œä¹Ÿå°±æ˜¯ $d\bar{\mathbf{w}}$ã€‚è¿™æ„å‘³ç€ï¼š

- æ¯æ¬¡ç”Ÿæˆå›¾åƒçš„è¿‡ç¨‹å¯èƒ½ä¸åŒ
- æ¨¡åž‹ä¸å®¹æ˜“ç²¾ç¡®æŽ§åˆ¶

äºŽæ˜¯æˆ‘ä»¬å¼•å…¥ä¸€ä¸ªâ€œç¡®å®šæ€§ç‰ˆæœ¬â€ï¼š

------

#### ðŸ“˜ å…¬å¼ (23)ï¼šæ¦‚çŽ‡æµ ODE

$$
dx = \left[f(x, k) - \frac{1}{2}g(k)^2 \nabla_x \log p_k(x) \right] dk
$$

å’Œå…¬å¼ (19) ç±»ä¼¼ï¼Œä½†æ˜¯**æ²¡æœ‰éšæœºæ‰°åŠ¨é¡¹**ï¼Œä¹Ÿå°±æ˜¯ï¼š

- æ¯æ¬¡ç”Ÿæˆçš„ç»“æžœæ˜¯å®Œå…¨ç¡®å®šçš„
- æ›´åƒâ€œå¸¸å¾®åˆ†æ–¹ç¨‹â€ï¼ˆODEï¼‰è€Œä¸æ˜¯éšæœºè¿‡ç¨‹
- ç”¨èµ·æ¥å¯ä»¥æ›´ç¨³å®šã€æ›´æ˜“è®­ç»ƒï¼Œé€‚åˆåšæœ€å¤§ä¼¼ç„¶ä¼°è®¡

#### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> å…¬å¼ (18)-(23) æ˜¯åœ¨å‘Šè¯‰ä½ ï¼Œæ‰©æ•£æ¨¡åž‹å¯ä»¥ç”¨â€œè¿žç»­æ—¶é—´çš„æ•°å­¦è¯­è¨€ï¼ˆSDE/ODEï¼‰â€æ¥æè¿°å’Œå®žçŽ°ã€‚
>  æ­£å‘æ˜¯ä¸æ–­åŠ å™ªï¼Œåå‘æ˜¯æ²¿ç€å¾—åˆ†æ–¹å‘åŽ»å™ªã€‚ä¸ºäº†æ›´å¯æŽ§ï¼Œè¿˜å¯ä»¥ç”¨æ¦‚çŽ‡æµ ODE å®žçŽ°ä¸€ä¸ª**æ— å™ªå£°çš„ç¡®å®šæ€§ç”Ÿæˆè¿‡ç¨‹**ã€‚

### 2.2.3 Conditional Diffusion

#### âœ¨ ç¬¬ä¸€ç§æ–¹å¼ï¼šæ¡ä»¶å»ºæ¨¡ during è®­ç»ƒé˜¶æ®µï¼ˆå›¾ Figure 8ï¼‰

è¿™å…¶å®žå’Œæ™®é€šåŽ»å™ªè¿‡ç¨‹ç±»ä¼¼ï¼Œåªä¸è¿‡æˆ‘ä»¬åœ¨æ¨¡åž‹è¾“å…¥é‡Œ**åŠ ä¸Šäº†æ¡ä»¶ `c`**ã€‚

**å¯¹åº”å…¬å¼ï¼š**
$$
p_\theta(x^{k-1}|x^k, c) = \mathcal{N}(x^{k-1}; \mu_\theta(x^k, k, c), \sigma_k^2 I)
$$
å’Œä¹‹å‰çš„åå‘è¿‡ç¨‹å‡ ä¹Žä¸€æ ·ï¼Œåªæ˜¯çŽ°åœ¨æ¯ä¸€æ­¥éƒ½å¸¦ä¸Šäº†æ¡ä»¶ `c`ã€‚

**æ¨¡åž‹é¢„æµ‹çš„æ–¹å¼ä¹Ÿè¢«â€œåŠ äº†æ¡ä»¶â€ï¼š**

- å™ªå£°é¢„æµ‹æ–¹å¼ï¼š
  $$
  \mu_\epsilon(\epsilon_\theta, c)
  $$

- åŽŸå›¾é¢„æµ‹æ–¹å¼ï¼š
  $$
  \mu_x(x_\theta, c)
  $$

è¿™äº›å…¬å¼éƒ½å’Œä¹‹å‰ä¸€æ ·ï¼Œåªä¸è¿‡ç¥žç»ç½‘ç»œæŽ¥æ”¶äº†é¢å¤–çš„æ¡ä»¶è¾“å…¥ `c`ï¼Œå›¾ Figure 8 ä¹Ÿè¯´æ˜Žäº†è¿™ä¸€ç‚¹ã€‚

------

#### ðŸ§² ç¬¬äºŒç§æ–¹å¼ï¼šDiffusion Guidance during æŽ¨ç†é˜¶æ®µï¼ˆå›¾ Figure 9ï¼‰

è¿™æ˜¯ä¸€ç§æ›´çµæ´»ã€æ›´èªæ˜Žçš„æ–¹æ³•ï¼š**åœ¨æŽ¨ç†ï¼ˆé‡‡æ ·ï¼‰çš„æ—¶å€™å†å¼•å¯¼æ¨¡åž‹å¾€â€œç›®æ ‡æ–¹å‘â€ç”Ÿæˆ**ã€‚

ä¹Ÿå°±æ˜¯ï¼š

- æ¨¡åž‹åŽŸæ¥è®­ç»ƒçš„æ—¶å€™æ²¡å¸¦æ¡ä»¶
- ä½†çŽ°åœ¨æˆ‘å¯ä»¥åœ¨é‡‡æ ·çš„æ—¶å€™ï¼Œç”¨**è´å¶æ–¯è§„åˆ™**å¼•å¯¼å®ƒå¾€æƒ³è¦çš„æ ·å­é è¿‘ï¼

------

**ç”¨è´å¶æ–¯å…¬å¼é‡æ–°å†™æ¡ä»¶æ¦‚çŽ‡ï¼š**
$$
p(x^k | c) \propto p(c | x^k) \cdot p(x^k)
$$
å–å¯¹æ•°åŽï¼ŒæŽ¨å¯¼å‡ºâ€œå¼•å¯¼æ¢¯åº¦â€ï¼š
$$
\nabla_{x^k} \log p(x^k | c) = \nabla_{x^k} \log p(c | x^k) + \nabla_{x^k} \log p(x^k)
$$
è¿™ä¸ªå¯¼æ•°å°±æ˜¯â€œå¾€æ»¡è¶³æ¡ä»¶çš„æ–¹å‘å¾®è°ƒâ€çš„æ–¹å¼ã€‚

------

âœ¨ **æœ€ç»ˆé‡‡æ ·æ–¹å¼å˜æˆ**ï¼ˆå…¬å¼ 32ï¼‰ï¼š
$$
p_\theta(x^{k-1}|x^k) = \mathcal{N}\left(\mu_\theta(x^k, k), \sigma_k^2 I\right) + s\sigma_k^2 \nabla_{x^k} \log p(c | x^k)
$$
çº¢æ¡†é‡ŒåŠ äº†ä¸€é¡¹ï¼š

- $\nabla_{x^k} \log p(c | x^k)$ï¼š**è¿™ä¸ªå‘Šè¯‰ä½ ï¼šæ€Žä¹ˆè®©ç”Ÿæˆç»“æžœæ›´åƒä½ è¦çš„æ¡ä»¶**
- $s$ï¼šå¼•å¯¼å¼ºåº¦ï¼ˆå¯ä»¥æŽ§åˆ¶â€œåƒæ¡ä»¶â€è¿˜æ˜¯â€œä¿æŒè‡ªç„¶â€ï¼‰

## 2.3 Related Papers

### 2.3.1 TimeGrad

Autoregressive Denoising Diffusion Models for Multivariate Probabilistic Time Series Forecasting (2021) 

#### ðŸ§ ä»€ä¹ˆæ˜¯ Autoregressiveï¼Ÿï¼ˆè‡ªå›žå½’ï¼‰

**Autoregressiveï¼ˆARï¼Œè‡ªå›žå½’ï¼‰** æ˜¯æ—¶é—´åºåˆ—å»ºæ¨¡é‡Œå¾ˆç»å…¸çš„æ¦‚å¿µï¼š

> ä¸€ä¸ªæ¨¡åž‹æ˜¯â€œè‡ªå›žå½’çš„â€ï¼Œæ„æ€æ˜¯ï¼š
>  **å½“å‰æ—¶åˆ»çš„è¾“å‡ºä¾èµ–äºŽå‰é¢å·²ç»é¢„æµ‹å‡ºæ¥çš„ç»“æžœã€‚**

#### ðŸ” åœ¨ TimeGrad ä¸­â€œAutoregressiveâ€çš„ä½“çŽ°

TimeGrad é¢„æµ‹çš„æ˜¯æœªæ¥çš„å¤šæ­¥å€¼ï¼ˆä¾‹å¦‚æœªæ¥ 24 æ­¥çš„ç”µåŠ›éœ€æ±‚ï¼‰ï¼Œå®ƒæ²¡æœ‰ä¸€æ¬¡æ€§åŒæ—¶è¾“å‡ºå…¨éƒ¨ï¼Œè€Œæ˜¯**ä¸€æ­¥ä¸€æ­¥åœ°é¢„æµ‹ï¼š**
$$
x_1 \rightarrow x_2 \rightarrow x_3 \rightarrow \cdots \rightarrow x_F
$$

------

ðŸ§± **å¯¹åº”å…¬å¼ä½ç½®åœ¨å“ª**ï¼Ÿ

âœ… å…¬å¼ (36)ï¼š
$$
p_\theta(X^{0:K}_{tar} \mid X_{obs}) = \prod_{t=1}^F p_\theta(x^{0:K}_t \mid h_{t-1})
$$
è¿™å¥è¯çš„æ„æ€æ˜¯ï¼š**ç¬¬ $t$ ä¸ªæœªæ¥å€¼çš„é¢„æµ‹ï¼Œæ˜¯ä¾èµ–äºŽå‰ $t-1$ æ­¥çš„ä¿¡æ¯çš„ã€‚**

è€Œ $h_{t-1}$ æ˜¯é€šè¿‡ RNN æ¥ç¼–ç å‰é¢åŽ†å²+é¢„æµ‹ç»“æžœå¾—åˆ°çš„éšè—çŠ¶æ€ã€‚

âœ… å…¬å¼ (37)ï¼š
$$
p_0(X_{tar}^{0:K} | X_{obs}) = \prod_{t=1}^F p(x_t^K) \prod_{k=1}^K p(x_t^{k-1} | x_t^k, \mathbf{h}_{t-1})
$$
æ³¨æ„è¿™é‡Œçš„å†™æ³•æ˜¯ $\prod_{t=1}^F \prod_{k=1}^K$ï¼Œå³å¯¹æ¯ä¸ªæœªæ¥æ—¶é—´æ­¥ï¼Œéƒ½åš $K$ æ­¥æ‰©æ•£ã€‚è¿™ç§å»ºæ¨¡æ–¹å¼å…¶å®žæ˜¯â€œè‡ªå›žå½’â€æ€æƒ³çš„å»¶ä¼¸ï¼Œæ¯ä¸ªæ—¶é—´æ­¥éƒ½æ¡ä»¶äºŽä¹‹å‰çš„åŽ†å²å’Œé¢„æµ‹ã€‚å…¬å¼ï¼ˆ37ï¼‰å®žé™…ä¸ŠæŠŠ DDPM çš„å•æ ·æœ¬æ‰©æ•£ï¼Œå˜æˆäº†â€œæ¯ä¸ªæ—¶é—´æ­¥ç‹¬ç«‹æ‰©æ•£â€ï¼Œå¹¶ç”¨ RNN ç¼–ç åŽ†å²ã€‚

------

âœ… å…¬å¼ (35)ï¼š
$$
h_t = \text{RNN}_\theta(\text{concat}(x^v_t, c_t), h_{t-1})
$$

- RNN æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ç§è‡ªå›žå½’ç»“æž„ï¼Œå› ä¸ºæ¯ä¸€æ­¥çš„è¾“å‡ºéƒ½è¦ç”¨ä¸Šå‰ä¸€æ­¥çš„éšè—çŠ¶æ€ã€‚
- åœ¨ TimeGrad é‡Œï¼Œè¿™ä¸ªéšè—çŠ¶æ€ $h_{t-1}$ ä¼šå½±å“ä¸‹ä¸€ä¸ªæ—¶é—´ç‚¹çš„é¢„æµ‹ã€‚

âœ… å…¬å¼ (38)ï¼š
$$
\mathcal{L}_{t,\epsilon_\theta}=\mathbb{E}_{k,x_t^0,\epsilon}\left[||\epsilon-\epsilon_\theta(x^k,k|\mathbf{h}_{t-1})||^2\right]
$$

#### âœ… æ€»ç»“ä¸€å¥è¯ï¼š

> **TimeGrad ä¹‹æ‰€ä»¥å« â€œAutoregressiveâ€ï¼Œæ˜¯å› ä¸ºå®ƒæ˜¯ä¸€æ­¥ä¸€æ­¥é¢„æµ‹æœªæ¥çš„æ—¶é—´ç‚¹ï¼Œæ¯ä¸€æ­¥éƒ½ä¾èµ–äºŽå‰é¢å·²ç»é¢„æµ‹çš„å†…å®¹ï¼Œè¿™ç§ç»“æž„å°±å«è‡ªå›žå½’ã€‚**
>  å®ƒçš„â€œè‡ªå›žå½’æ€§â€ä½“çŽ°åœ¨ï¼šä½¿ç”¨ RNN çš„éšè—çŠ¶æ€ $h_{t-1}$ æ¥é¢„æµ‹æ¯ä¸€ä¸ªæ—¶é—´æ­¥ï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªæœªæ¥ç‚¹æ˜¯æŒ‰é¡ºåºã€é€’æŽ¨åœ°é¢„æµ‹å‡ºæ¥çš„ã€‚

### 2.3.2 ScoreGrad

Multivariate Probabilistic Time Series Forecasting with Continuous Energy-based Generative Models (2021)

#### âœ… å°ç»“ä¸€ä¸‹ï¼š

| é—®é¢˜                   | å›žç­”                                                         |
| ---------------------- | ------------------------------------------------------------ |
| ScoreGrad æ”¹è¿›äº†ä»€ä¹ˆï¼Ÿ | ä»Žç¦»æ•£DDPMæ¢æˆè¿žç»­SDEï¼Œæ›´çµæ´»ã€æ€§èƒ½æ›´å¥½                      |
| æœ‰ä»€ä¹ˆæ–°ç¬¦å·ï¼Ÿ         | $\mathbf{F}_t$ æ›¿ä»£ $h_t$ è¡¨ç¤ºåŽ†å²ä¿¡æ¯ï¼Œscoreé¢„æµ‹ç”¨ $s_\theta$ |
| æ¨¡åž‹ç»“æž„æ˜¯æ€Žæ ·çš„ï¼Ÿ     | ä»ç„¶æ˜¯è‡ªå›žå½’ç»“æž„ï¼Œä¸€æ­¥é¢„æµ‹ä¸€æ­¥ï¼Œé€‚ç”¨äºŽå¤šå˜é‡æ—¶é—´åºåˆ—         |
| è¡¨æ ¼è¯´æ˜Žäº†ä»€ä¹ˆï¼Ÿ       | ScoreGrad å°¤å…¶æ˜¯ sub-VP SDE æ•ˆæžœæ›´å¥½ï¼Œå°¤å…¶åœ¨ç”µåŠ›æ•°æ®é›†ä¸Šè¡¨çŽ°æžå¥½ |

### 2.3.3 CSDI

Conditional Score-based Diffusion Models for Probabilistic Time Series Imputation (2021)

#### ðŸ“Œ ä¸Ž TimeGrad / ScoreGrad çš„ä¸åŒç‚¹ï¼Ÿ

| é¡¹ç›®        | TimeGrad / ScoreGrad | CSDI                  |
| --------- | -------------------- | --------------------- |
| ä»»åŠ¡        | é¢„æµ‹æœªæ¥æ—¶é—´ç‚¹              | è¡¥å…¨ä»»æ„ç¼ºå¤±å€¼ï¼ˆé¢„æµ‹è¿‡åŽ»ã€çŽ°åœ¨æˆ–æœªæ¥ï¼‰   |
| æ¡ä»¶ä¿¡æ¯ç¼–ç     | ç”¨ RNN æˆ–å…¶ä»–æ¨¡åž‹ç¼–ç åŽ†å²ä¿¡æ¯    | ç”¨ Transformer ç¼–ç æ¡ä»¶ä½ç½®  |
| æ˜¯å¦æŒ‰æ—¶é—´é¡ºåºç”Ÿæˆ | æ˜¯ï¼ˆautoregressiveï¼‰    | å¦ï¼Œå¯ä»¥å¹¶è¡Œè¡¥å…¨å¤šä¸ªä½ç½®          |
| ç‰¹ç‚¹        | é€‚åˆ forecasting       | é€‚åˆ imputationï¼ˆå¸¦ maskï¼‰ |

### 2.3.4 DSPD & CSPD

DSPD & CSPD: Modeling Temporal Data as Continuous Functions with Process Diffusion (2022)

#### â“é—®é¢˜ 1ï¼š

**â€œTimeGrad å’Œ DSPD é™¤äº†å™ªå£°æ”¹åŠ¨å¤–ï¼Œæ˜¯å¦å…¶ä»–æ–¹é¢æ˜¯ç›¸ä¼¼çš„ï¼Ÿâ€**

#### âœ… è¡¨é¢ä¸Šçš„ç›¸ä¼¼æ€§ï¼š

- **RNN æå–åŽ†å²æ¡ä»¶ z**ï¼šä¸¤è€…éƒ½ä½¿ç”¨ RNN ç¼–ç åŽ†å²åºåˆ—ï¼Œä½œä¸ºé¢„æµ‹æœªæ¥åºåˆ—çš„æ¡ä»¶å‘é‡ã€‚
- **é¢„æµ‹ç›®æ ‡ä¸€è‡´**ï¼šéƒ½ç”¨äºŽå¤šæ­¥æ—¶é—´åºåˆ—é¢„æµ‹ä»»åŠ¡ã€‚
- **æž¶æž„å‡åŸºäºŽ DDPM æ€è·¯ï¼ˆåå‘é¢„æµ‹ï¼‰**ï¼šé€šè¿‡å¤šä¸ªåå‘æ‰©æ•£æ­¥éª¤æ¥é€æ­¥æž„å»ºæœªæ¥æ—¶é—´ç‚¹çš„é¢„æµ‹ã€‚
- **ä½¿ç”¨é‡å‚æ•°åŒ–æŠ€æœ¯é¢„æµ‹å™ªå£° Îµ**ã€‚
- **ä¼˜åŒ–ç›®æ ‡å‡½æ•°å½¢å¼ä¸€è‡´**ï¼ˆå¦‚ Equation 48 æ‰€ç¤ºï¼‰ã€‚

#### â—æœ¬è´¨æ€§å·®å¼‚ï¼š

1. **å™ªå£°å»ºæ¨¡æ–¹å¼æ ¹æœ¬ä¸åŒ**ï¼š
   - **TimeGrad** é‡‡ç”¨ *ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆi.i.dï¼‰* å™ªå£°ï¼ˆé€šå¸¸æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼‰ã€‚
   - **DSPD** é‡‡ç”¨ *æ—¶é—´ç›¸å…³çš„é«˜æ–¯è¿‡ç¨‹å™ªå£°*ï¼Œå³ $\epsilon(\cdot) \sim \mathcal{GP}$ï¼Œå¹¶å‡è®¾å™ªå£°åœ¨ä¸åŒæ—¶é—´æ­¥é—´æœ‰ç»“æž„æ€§ç›¸å…³æ€§ã€‚
   - è¿™å¯¼è‡´æ¨¡åž‹ç”Ÿæˆåºåˆ—æ—¶å…·æœ‰æ›´å¹³æ»‘ã€è¿žè´¯çš„è¡Œä¸ºã€‚
2. **å¤šæ­¥è”åˆé¢„æµ‹ vs å•æ­¥é€’å½’é¢„æµ‹**ï¼š
   - **TimeGrad** ä¸»è¦æ˜¯å•æ­¥é¢„æµ‹å†é€’å½’å¤šæ­¥ã€‚
   - **DSPD** åœ¨æž¶æž„ä¸Šè¿›è¡Œäº†æ”¹è¿›ï¼Œå¯ä»¥ä¸€æ¬¡æ€§é¢„æµ‹å¤šä¸ªæ—¶é—´ç‚¹ï¼ˆè§ç¬¬ä¸€å¼ å›¾ç¬¬äºŒæ®µï¼šâ€œ...predict multiple values at the same time...â€ï¼‰ã€‚
3. **è¾“å…¥å»ºæ¨¡ç»´åº¦å˜åŒ–**ï¼š
   - DSPD ä½¿ç”¨ 2D å·ç§¯ï¼ˆæ›¿ä»£ RNN çš„å †å ç»“æž„ï¼‰å¤„ç†æ—¶é—´åºåˆ—ï¼Œä»¥æå‡å¹¶è¡Œæ€§ã€‚
   - TimeGrad ä½¿ç”¨æ ‡å‡† RNN ç»“æž„é€æ­¥ç¼–ç åºåˆ—ã€‚

> âœ… **ç»“è®º**ï¼šè™½ç„¶ TimeGrad å’Œ DSPD åœ¨ç›®æ ‡å’Œéƒ¨åˆ†æž¶æž„ä¸Šç›¸ä¼¼ï¼Œä½† DSPD é€šè¿‡æ”¹å˜å™ªå£°å»ºæ¨¡æ–¹å¼ + å¹¶è¡Œå¤šæ­¥é¢„æµ‹æœºåˆ¶ï¼Œå¯¹åŽŸå§‹æž¶æž„è¿›è¡Œäº†å…³é”®æ€§çš„æå‡ã€‚å®ƒä¸æ˜¯ä¸€ä¸ªç®€å•â€œåŠ ä¸Š GPâ€çš„ TimeGradï¼Œè€Œæ˜¯ä¸€ä¸ªä»Žå™ªå£°å»ºæ¨¡åˆ°è®¡ç®—æ•ˆçŽ‡éƒ½åšäº†å…¨é¢ä¼˜åŒ–çš„ç³»ç»Ÿã€‚

#### â“é—®é¢˜ 2ï¼š

**â€œScoreGrad å¯ä»¥ç”¨äºŽé¢„æµ‹ï¼Œé‚£ CSPD æ˜¯ ScoreGrad å—ï¼Ÿâ€**

è™½ç„¶ ScoreGrad å’Œ CSPDï¼š

- éƒ½ä½¿ç”¨ **è¿žç»­æ—¶é—´æ‰©æ•£ï¼ˆSDEï¼‰** å»ºæ¨¡ï¼›
- éƒ½ä¾èµ– **score function** è®­ç»ƒæœºåˆ¶ï¼›
- éƒ½ç”¨äºŽ **æ—¶é—´åºåˆ—é¢„æµ‹**ï¼›

ä½† CSPD **åœ¨å®žçŽ°ä¸Šåšäº†ä¸¤ä¸ªå…³é”®æ€§ç»“æž„ä¿®æ”¹**ï¼Œä»Žè€Œå°† ScoreGrad çš„é€šç”¨æ¡†æž¶æ”¹é€ æˆä¸€ä¸ªä¸“é—¨ç”¨äºŽé«˜æ•ˆé¢„æµ‹çš„æ¨¡åž‹ï¼š

1. **å™ªå£°å»ºæ¨¡å±‚é¢**ï¼šCSPD å¼•å…¥ **é«˜æ–¯è¿‡ç¨‹å™ªå£°**ï¼Œè€Œä¸æ˜¯ ScoreGrad ä¸­çš„ç‹¬ç«‹å™ªå£°ã€‚
2. **æ—¶é—´ç¼–ç æž¶æž„ä¸Š**ï¼šCSPD æ˜Žç¡®ä½¿ç”¨ RNN + å¹¶è¡Œé¢„æµ‹æœºåˆ¶ï¼ˆä¸€æ¬¡æ€§é¢„æµ‹å¤šä¸ªæ—¶é—´ç‚¹ï¼‰ï¼Œè€Œ ScoreGrad çš„ç»“æž„ä¾èµ–ç”¨æˆ·é€‰ç”¨ Transformer ç­‰å¹¶æœªç»Ÿä¸€ã€‚

å› æ­¤ï¼š

> **CSPD â‰  ScoreGradï¼Œä½†å®ƒå¯ä»¥çœ‹ä½œæ˜¯â€œScoreGrad åœ¨é¢„æµ‹ä»»åŠ¡ä¸Šçš„ç»“æž„æ€§è¿›åŒ–ç‰ˆæœ¬â€ã€‚**

### 2.3.5 DÂ³VAE

Generative Time Series Forecasting with Diffusion, Denoise, and Disentanglement (2022)

#### ðŸ§± æ ¸å¿ƒåˆ›æ–°ç»“æž„

| æ¨¡å—                           | è§£é‡Š                                                           |
| ---------------------------- | ------------------------------------------------------------ |
| ðŸ” Coupled Diffusion Process | å¯¹åŽ†å²å’Œæœªæ¥çª—å£åŒæ—¶åŠ å™ªå£°ï¼Œä½¿ç”Ÿæˆè¿‡ç¨‹æ›´é²æ£’ï¼›å¹¶é€šè¿‡ç†æƒ³+å™ªå£°åˆ†è§£ï¼ˆEquations 49 & 50ï¼‰ç¼“è§£å™ªå£°ä¼ æ’­é—®é¢˜ |
| ðŸ§  BVAE                      | ä½¿ç”¨è§‚æµ‹å€¼ $X^{k}_{obs}$ ç¼–ç æ½œå˜é‡  $Zâˆ¼p_\theta(Zâˆ£X^{k}_{tar})$       |
| ðŸ§¼ DSM                       | å•æ­¥æ¢¯åº¦ä¿®æ­£é¢„æµ‹ç»“æžœï¼Œå¼•å¯¼æ ·æœ¬æ›´è´´è¿‘çœŸå®žåˆ†å¸ƒï¼ˆEquation 51ï¼‰                          |
| ðŸŽ¯ Loss ç»„åˆ                   | æ€»æŸå¤±åŒ…æ‹¬ KL æ•£åº¦ã€DSM lossã€è§£è€¦ lossã€é‡æž„è¯¯å·®ï¼ˆEquation 52ï¼‰               |

#### ðŸ§ æ‰¹åˆ¤æ€§ä¼˜ç¼ºç‚¹åˆ†æž

| ä¼˜åŠ¿                                     | åŠ£åŠ¿                                 |
| -------------------------------------- | ---------------------------------- |
| âœ… å‡ºè‰²çš„å°æ ·æœ¬è¡¨çŽ°èƒ½åŠ›ï¼Œé²æ£’æ€§å¼º                      | â— è®­ç»ƒå¤æ‚ã€è¶…å‚æ•°ä¼—å¤šã€éš¾ä»¥æ”¶æ•›                  |
| âœ… åŒæ—¶å»ºæ¨¡ä¸¤ç§ä¸ç¡®å®šæ€§ï¼ˆæ¨¡åž‹ & æ•°æ®ï¼‰                  | â— åœ¨å¤§æ•°æ®æƒ…å½¢ä¸‹ç•¥æ˜¾ç»“æž„å†—ä½™                    |
| âœ… ä½¿ç”¨è€¦åˆæ‰©æ•£ï¼Œç†è®ºä¸Šæ¯” ScoreGrad / TimeGrad æ›´å®Œæ•´ | â— è®­ç»ƒè¿‡ç¨‹é«˜åº¦ä¾èµ–ç‰¹å®šè°ƒå‚å’Œåˆå§‹åŒ–ç­–ç•¥               |
| âœ… è§£è€¦ latent variable æå‡è§£é‡Šæ€§             | â— æœªåœ¨æ ‡å‡† GluonTS æ•°æ®ä¸Šåšç›´æŽ¥å¯¹æ¯”ï¼Œç»“æžœå¯è¿ç§»æ€§å°šéœ€éªŒè¯ |

### 2.3.6 TDSTF

Transformer-based Diffusion probabilistic model for Sparse Time series Forecasting (2023) 

#### ðŸ§± æ ¸å¿ƒåˆ›æ–°ç»“æž„

TDSTF æ¨¡åž‹å—åˆ° CSDI çš„å¯å‘ï¼Œä¸»è¦ç”¨äºŽ ICU ç—…äººç”Ÿå‘½ä½“å¾çš„ç¨€ç–å¤šå˜é‡æ—¶é—´åºåˆ—é¢„æµ‹ã€‚å®ƒçš„æ ¸å¿ƒåˆ›æ–°åœ¨äºŽï¼š

- **ä¸‰å…ƒç»„è¡¨ç¤ºæ³•**ï¼šæ¨¡åž‹ç”¨ (ç‰¹å¾, æ—¶é—´, æ•°å€¼) çš„ä¸‰å…ƒç»„å½¢å¼æ¥è¡¨è¾¾ç¨€ç–æ•°æ®ï¼ŒåŒæ—¶è¿˜é…æœ‰ä¸€ä¸ª maskï¼Œæ ‡è®°è¯¥ä¸‰å…ƒç»„æ•°æ®æ˜¯å¦å­˜åœ¨ã€‚
- **Transformer ç¼–ç å™¨**ï¼šç”¨ Transformer ç½‘ç»œå¯¹åŽ†å²æ•°æ®è¿›è¡Œç¼–ç ï¼Œè‡ªåŠ¨é€‰æ‹©æœ€ç›¸å…³çš„æ•°æ®ç‚¹ä½œä¸ºè¾“å…¥ã€‚

è¿™ç§è®¾è®¡éžå¸¸é€‚åˆå¤„ç†ä¸´åºŠæ•°æ®çš„ç¨€ç–æ€§ï¼Œæ—¢èƒ½ä¿æŠ¤æ—¶é—´ä¿¡æ¯çš„å®Œæ•´æ€§ï¼Œåˆèƒ½å‡å°‘æ’å€¼æˆ–èšåˆå¸¦æ¥çš„å™ªå£°ã€‚

#### ðŸ§ æ‰¹åˆ¤æ€§ä¼˜ç¼ºç‚¹åˆ†æž

- **ä¼˜åŠ¿ï¼š** TDSTF åœ¨ç¨€ç–æ•°æ®åœºæ™¯ä¸‹è¡¨çŽ°ä¼˜å¼‚ï¼Œå°¤å…¶é€‚åˆåŒ»ç–—ç­‰å¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚é«˜çš„é¢†åŸŸã€‚
- **ç–‘é—®ï¼š** å…¶ä¸‰å…ƒç»„ä¸Ž mask çš„è®¾è®¡æ˜¯å¦çœŸçš„èƒ½æ³›åŒ–åˆ°å…¶ä»–ç¨€ç–åœºæ™¯ï¼Ÿæ¨¡åž‹åœ¨æ•°æ®æžåº¦ç¼ºå¤±æˆ–å™ªå£°æžå¤§çš„æƒ…å†µä¸‹ä»èƒ½ä¿æŒä¼˜åŠ¿å—ï¼Ÿ

### 2.3.7 SSSDS4

Diffusion-based Time Series Imputation and Forecasting with Structured State Space Models (2023) 

---

#### ä¸€ã€æ¨¡åž‹æ•´ä½“æ€è·¯

SSSD$^{S4}$æ˜¯å—DiffWaveå’ŒCSDIå¯å‘çš„æ‰©æ•£æ¨¡åž‹ï¼Œç”¨äºŽæ—¶é—´åºåˆ—çš„è¡¥å…¨å’Œé¢„æµ‹ã€‚å®ƒæœ‰ä¸‰ä¸ªæ˜¾è‘—åˆ›æ–°ï¼š

1. **é‡‡ç”¨S4æ¨¡åž‹ä»£æ›¿ä¼ ç»Ÿå·ç§¯/Transformerå±‚**  
   S4ï¼ˆStructured State Space Sequence Modelï¼‰å–„äºŽæ•æ‰é•¿æ—¶ä¾èµ–ï¼Œæ¯”ä¼ ç»Ÿçš„å·ç§¯æˆ–Transformeråœ¨é•¿åºåˆ—å»ºæ¨¡ä¸Šæ›´é«˜æ•ˆã€‚

2. **è¾“å…¥æ•°æ®å½¢çŠ¶å˜åŒ–**  
   CSDIçš„è¾“å…¥shapeæ˜¯(batch dim, diffusion dim, input channel dim, time dim)ï¼Œè€ŒSSSD$^{S4}$æŠŠè¾“å…¥é€šé“æ˜ å°„åˆ°æ‰©æ•£ç»´åº¦ï¼Œåªåœ¨æ—¶é—´ç»´åº¦åšæ‰©æ•£(batch dim, diffusion dim, time dim)ã€‚è¿™ä¸Žå¤„ç†éŸ³é¢‘ã€å›¾åƒçš„æ‰©æ•£æ¨¡åž‹åšæ³•ä¸€è‡´ã€‚

3. **åªå¯¹éœ€è¦è¡¥å…¨çš„ç‰‡æ®µåšæ‰©æ•£å¤„ç†**  
   åªå¯¹éœ€è¦è¡¥å…¨çš„ç‰‡æ®µåŠ å™ªå£°è¿›è¡Œæ‰©æ•£ï¼Œè€Œä¸æ˜¯å¯¹æ‰€æœ‰ç‰‡æ®µã€‚è¿™æ¯”CSDIæ–¹æ³•æ›´ç²¾å‡†â€”â€”CSDIæ˜¯å¯¹æ‰€æœ‰æ’å€¼ç›®æ ‡åŠ å™ªå£°ï¼Œè¿˜è¦ç”¨maskä¿®æ­£shapeï¼ŒSSSD$^{S4}$åˆ™å¹²è„†å¯¹ç¼ºå¤±å€¼ä¸åŠ å™ªå£°ã€‚

**è´¨ç–‘ä¸Žæ€è€ƒ**ï¼š  
è¿™ç§åšæ³•æ˜¯å¦ä¼šå¯¼è‡´æ¨¡åž‹å¯¹å¼‚å¸¸ç‚¹æˆ–æžç«¯ç¼ºå¤±åœºæ™¯ä¸‹æ³›åŒ–èƒ½åŠ›å˜å¼±ï¼Ÿåªå¯¹éƒ¨åˆ†ç‰‡æ®µæ‰©æ•£ï¼Œæ˜¯å¦ä¼šå½±å“å…¨å±€çš„æ—¶é—´ä¸€è‡´æ€§ï¼Ÿ

---

#### äºŒã€å…¬å¼ä¸Žç¬¦å·è§£é‡Š

å›¾ç‰‡3åº•éƒ¨ç»™å‡ºäº†S4æ¨¡åž‹çš„æ ¸å¿ƒå…¬å¼ï¼š

$$
x'(t) = Ax(t) + Bu(t) \text{ and }
y(t) = Cx(t) + Du(t)
$$

- $x(t)$ï¼šNç»´éšè—çŠ¶æ€å‘é‡ï¼Œæè¿°åºåˆ—çš„å†…éƒ¨è®°å¿†
- $u(t)$ï¼š1ç»´è¾“å…¥åºåˆ—ï¼ˆå¯ä»¥ç†è§£ä¸ºæ¯æ—¶åˆ»çš„è§‚æµ‹å€¼ï¼‰
- $y(t)$ï¼š1ç»´è¾“å‡ºåºåˆ—ï¼ˆæ¨¡åž‹çš„é¢„æµ‹ç»“æžœï¼‰
- $A, B, C, D$ï¼šçŠ¶æ€ç©ºé—´æ¨¡åž‹çš„è½¬ç§»çŸ©é˜µï¼ŒæŽ§åˆ¶è¾“å…¥ã€éšè—çŠ¶æ€å’Œè¾“å‡ºä¹‹é—´çš„å…³ç³»

**ç›´è§‚ç†è§£**ï¼š  
å…¶å®žè¿™å’ŒæŽ§åˆ¶ç†è®ºé‡Œçš„çŠ¶æ€ç©ºé—´æ¨¡åž‹å¾ˆåƒâ€”â€”$x(t)$è®°å½•äº†åºåˆ—çš„â€œåŽ†å²è®°å¿†â€ï¼Œ$u(t)$æ˜¯å½“å‰è¾“å…¥ï¼Œ$y(t)$æ˜¯è¾“å‡ºã€‚é€šè¿‡ä¸€ç»„çŸ©é˜µï¼Œæ¨¡åž‹èƒ½é«˜æ•ˆåœ°æ•æ‰é•¿æ—¶ä¾èµ–ã€‚S4å±‚å ªæ¯”â€œå¸¦è®°å¿†çš„çº¿æ€§å˜æ¢â€ï¼Œåœ¨é•¿æ—¶é—´åºåˆ—å¤„ç†ï¼ˆå¦‚åŒ»ç–—ã€é‡‘èžã€äº¤é€šï¼‰è¡¨çŽ°ä¼˜å¼‚ã€‚

**æ‰¹åˆ¤æ€§æ€è€ƒ**ï¼š  
S4æ¨¡åž‹è™½ç„¶é«˜æ•ˆï¼Œä½†æ˜¯å¦ä¼šå› å…¶çº¿æ€§ç»“æž„åœ¨å¤„ç†é«˜åº¦éžçº¿æ€§æ—¶åºå…³ç³»æ—¶å—åˆ°é™åˆ¶ï¼Ÿä½ å¯ä»¥æ€è€ƒä¸€ä¸‹ï¼Œå¦‚æžœæŠŠS4æ¢æˆéžçº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡åž‹ï¼Œèƒ½å¦è¿›ä¸€æ­¥æå‡å»ºæ¨¡èƒ½åŠ›ï¼Ÿ

---

#### ä¸‰ã€å®žéªŒç»“æžœä¸Žæ€»ç»“

å›¾ç‰‡4ä¸­çš„è¡¨æ ¼å±•ç¤ºäº†SSSD$^{S4}$å’Œå…¶ä»–æ–¹æ³•åœ¨å¤šä¸ªå…¬å¼€æ•°æ®é›†ä¸Šçš„è¡¨çŽ°ï¼ˆPTB-XLã€Solarã€ETTm1ï¼‰ï¼Œç”¨MAEå’ŒMSEæŒ‡æ ‡è¡¡é‡ï¼š

- **è¡¥å…¨ä»»åŠ¡ï¼ˆPTB-XLï¼‰**ï¼šSSSD$^{S4}$æ˜Žæ˜¾ä¼˜äºŽCSDIå’ŒSSSD$^{SA}$ï¼ˆ$0.087 \pm 8e-3$ vs $0.120 \pm 2e-4$ï¼‰ï¼Œè¯´æ˜ŽS4åœ¨å¤„ç†ç¼ºå¤±ç‰‡æ®µæ—¶æ›´ç²¾ç¡®ã€‚
- **é¢„æµ‹ä»»åŠ¡ï¼ˆETTm1ã€Solarï¼‰**ï¼šSSSD$^{S4}$ä¹Ÿä¼˜äºŽCSDI$^{S4}$ï¼Œå°¤å…¶åœ¨é«˜ç»´è¾“å…¥ï¼ˆå¤šä¸ªé€šé“ï¼‰æ—¶è¡¨çŽ°çªå‡ºã€‚

**å‰çž»æ€§ä¸Žè´¨ç–‘**ï¼š  
å®žéªŒå‘çŽ°ï¼Œéšç€è¾“å…¥é€šé“æ•°å¢žå¤šï¼ŒSSSD$^{S4}$çš„ç»´åº¦çº¦ç®€åè€Œå¯èƒ½å¤±æ•ˆâ€”â€”æ¨¡åž‹éš¾ä»¥é€šè¿‡æ‰©æ•£é€šé“æ¢å¤åŽŸå§‹è¾“å…¥é€šé“ã€‚è¿™æç¤ºæˆ‘ä»¬ï¼Œæœªæ¥å¯ä»¥å°è¯•å¤šé€šé“é—´çš„äº¤äº’å»ºæ¨¡ï¼Œæˆ–å¼•å…¥æ›´ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚

- SSSDS4çš„æœ€å¤§ä¼˜åŠ¿æ˜¯é«˜æ•ˆæ•æ‰é•¿æ—¶ä¾èµ–ã€è¡¥å…¨ç²¾åº¦é«˜ã€æŽ¨ç†é€Ÿåº¦å¿«ã€‚
- ä½†å®ƒå¯¹é«˜ç»´è¾“å…¥çš„è¡¥å…¨èƒ½åŠ›æœ‰é™ï¼Œä¸”å¯¹éžçº¿æ€§åºåˆ—å¯èƒ½æœ‰å±€é™ã€‚

---

### 2.3.8 DiffLoad

Uncertainty Quantification in Load Forecasting with Diffusion Model (2023) 

#### 1. æ¨¡åž‹ç»“æž„å’Œåˆ›æ–°ç‚¹

DiffLoadæœ¬è´¨ä¸Šæ˜¯ä¸€ç§åºåˆ—åˆ°åºåˆ—ï¼ˆseq2seqï¼‰æ¨¡åž‹ï¼Œæ ¸å¿ƒåˆ›æ–°åœ¨äºŽï¼š

- **åˆ©ç”¨æ‰©æ•£æ¨¡åž‹ï¼ˆDiffusion Modelï¼‰å¯¹éšè—çŠ¶æ€è¿›è¡Œå™ªå£°åŽ»é™¤**ï¼Œå³åœ¨ç¼–ç å™¨å’Œè§£ç å™¨ä¹‹é—´åŠ å…¥äº†ä¸€ä¸ªæ‰©æ•£è¿‡ç¨‹ã€‚
- **ä¸ç¡®å®šæ€§é‡åŒ–**ï¼šæ¨¡åž‹é€šè¿‡å¯¹éšè—å˜é‡è¿›è¡Œæ‰©æ•£å’ŒåŽ»å™ªï¼Œèƒ½å¤Ÿæ›´å¥½åœ°é‡åŒ–â€œæ¨¡åž‹æœ¬èº«çš„ä¸ç¡®å®šæ€§â€ï¼ˆå³epistemic uncertaintyï¼‰ã€‚
- **è¾“å‡ºåˆ†å¸ƒå¤´é‡‡ç”¨Cauchyåˆ†å¸ƒ**ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„é«˜æ–¯åˆ†å¸ƒï¼Œæ›´é€‚åˆåº”å¯¹å¼‚å¸¸å€¼å’Œé‡å°¾åˆ†å¸ƒï¼ˆå¾ˆå¤šå®žé™…è´Ÿè·æ•°æ®æœ‰å¼‚å¸¸ç‚¹ï¼‰ã€‚

#### 2. Cauchyåˆ†å¸ƒæ¨¡åž‹å¤´ï¼ˆCauchy Distribution Model Headï¼‰

- **éšè—çŠ¶æ€ç»è¿‡æ‰©æ•£åŽï¼Œä½œä¸ºè¾“å…¥ç”ŸæˆCauchyåˆ†å¸ƒçš„å‚æ•°**
  - å‡å€¼$\mu_\phi(t+1) = \text{NN}_1(\hat{h}_{t+1})$
  - æ ‡åº¦å‚æ•°ï¼ˆç±»ä¼¼æ ‡å‡†å·®ï¼Œä½†Cauchyåˆ†å¸ƒæ²¡æœ‰æ–¹å·®ï¼‰$\sigma_\phi(t+1) = \text{SoftPlus}(\text{NN}_2(\hat{h}_{t+1}))$

**ä¸ºä»€ä¹ˆç”¨Cauchyåˆ†å¸ƒï¼Ÿ**

- Cauchyåˆ†å¸ƒæ¯”é«˜æ–¯åˆ†å¸ƒâ€œå°¾å·´æ›´é‡â€ï¼Œå³æ›´å®¹æ˜“ç”Ÿæˆæžç«¯å€¼ï¼Œå¯¹å¼‚å¸¸ç‚¹ï¼ˆå¦‚çªå‘è´Ÿè·ï¼‰æ›´å¥å£®ã€‚
- åœ¨å®žé™…è´Ÿè·é¢„æµ‹ä¸­ï¼Œå¼‚å¸¸å€¼æ˜¯å¸¸è§é—®é¢˜ï¼ŒCauchyåˆ†å¸ƒèƒ½æ›´å¥½åœ°åæ˜ è¿™ç§ä¸ç¡®å®šæ€§ã€‚

### 2.3.9 TimeDiff

TimeDiff: Non-autoregressive Conditional Diffusion Models for Time Series Prediction (2023) 

#### æ ¸å¿ƒé—®é¢˜ï¼šæˆ‘ä»¬å¦‚ä½•æ‰èƒ½â€œä¸€æ¬¡æ€§â€åœ°ã€ä¸”â€œå’Œè°â€åœ°é¢„æµ‹æœªæ¥ï¼Ÿ

æƒ³è±¡ä¸€ä¸‹é¢„æµ‹å¤©æ°”ã€‚

*   **ä¸€ç§ä¼ ç»Ÿæ–¹æ³•ï¼ˆè‡ªå›žå½’/Autoregressiveï¼‰**ï¼šå°±åƒå¤šç±³è¯ºéª¨ç‰Œï¼Œä½ æ ¹æ®ä»Šå¤©çš„å¤©æ°”é¢„æµ‹æ˜Žå¤©çš„ï¼Œå†æ ¹æ®æ˜Žå¤©çš„é¢„æµ‹åŽå¤©çš„â€¦â€¦ä¸€æ­¥ä¸€æ­¥æ¥ã€‚è¿™ç§æ–¹æ³•å¾ˆç›´è§‚ï¼Œä½†æœ‰ä¸¤ä¸ªè‡´å‘½é—®é¢˜ï¼š
    1.  **æ…¢**ï¼šå¦‚æžœæƒ³é¢„æµ‹æœªæ¥30å¤©ï¼Œå°±è¦ç®—30æ¬¡ã€‚
    2.  **è¯¯å·®ç´¯ç§¯**ï¼šå¦‚æžœç¬¬ä¸€å¤©çš„é¢„æµ‹å°±æœ‰ç‚¹åï¼Œé‚£è¿™ä¸ªåå·®å°±ä¼šåƒæ»šé›ªçƒä¸€æ ·ï¼Œè¶Šå¾€åŽè¶Šç¦»è°±ã€‚

*   **ä¸€ç§æ›´æ¿€è¿›çš„æ–¹æ³•ï¼ˆéžè‡ªå›žå½’/Non-autoregressiveï¼‰**ï¼šæˆ‘ä»¬èƒ½ä¸èƒ½ä¸é‚£ä¹ˆéº»çƒ¦ï¼Œç›´æŽ¥â€œä¸€æ¬¡æ€§â€ç”Ÿæˆæœªæ¥30å¤©çš„å¤©æ°”é¢„æŠ¥ï¼Ÿè¿™å½“ç„¶å¿«å¤šäº†ï¼ä½†é—®é¢˜ä¹Ÿæ¥äº†ï¼šä½ ä¸€æ¬¡æ€§ç”Ÿæˆçš„è¿™30å¤©æ•°æ®ï¼Œå†…éƒ¨å¯èƒ½â€œä¸å’Œè°â€ï¼ˆè®ºæ–‡é‡Œå« **disharmony**ï¼‰ã€‚æ¯”å¦‚ï¼Œç¬¬10å¤©çš„é¢„æµ‹å’Œç¬¬11å¤©çš„é¢„æµ‹ä¹‹é—´å¯èƒ½ä¼šæœ‰ä¸ªèŽ«åå…¶å¦™çš„å‰§çƒˆè·³å˜ï¼Œå®Œå…¨ä¸ç¬¦åˆçœŸå®žä¸–ç•Œçš„è§„å¾‹ã€‚è¿™å°±å¥½æ¯”ä½ è®©ä¸€ä¸ªæ–°æ‰‹ç”»å¸ˆç›´æŽ¥ç”»ä¸€ä¸ªå®Œæ•´çš„äººï¼Œä»–å¯èƒ½æŠŠå¤´ç”»å¾—å¤ªå¤§ï¼Œèº«ä½“ç”»å¾—å¤ªå°ï¼Œæ¯”ä¾‹å¤±è°ƒã€‚

**TimeDiff è¿™ç¯‡è®ºæ–‡ï¼Œå°±æ˜¯æƒ³åœ¨â€œéžè‡ªå›žå½’â€è¿™æ¡è·¯ä¸Šèµ°å¾—æ›´è¿œï¼Œå®ƒæå‡ºçš„ç›®æ ‡æ˜¯ï¼šæ—¢è¦â€œä¸€æ¬¡æ€§â€ç”Ÿæˆé¢„æµ‹ï¼ˆå¿«ï¼‰ï¼Œåˆè¦ä¿è¯é¢„æµ‹ç»“æžœå†…éƒ¨æ˜¯â€œå’Œè°â€çš„ã€ç¬¦åˆæ—¶åºè§„å¾‹çš„ã€‚**

#### TimeDiff çš„ä¸¤ä¸ªâ€œå°èŠ±æ‹›â€

ä¸ºäº†å®žçŽ°è¿™ä¸ªç›®æ ‡ï¼Œè®ºæ–‡ä½œè€…è®¾è®¡äº†ä¸¤ä¸ªæ ¸å¿ƒæœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ›´ç›´è§‚çš„æ–¹å¼æ¥ç†è§£å®ƒä»¬ã€‚

#### 1. æœªæ¥æ··åˆ (Future Mixup)

* **ç›´è§‚ç†è§£**ï¼šè¿™å°±åƒæ˜¯ç»™æ¨¡åž‹ä¸€ä¸ªâ€œåŠå¼€å·â€çš„è€ƒè¯•ã€‚åœ¨è®­ç»ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬å½“ç„¶çŸ¥é“æœªæ¥çš„çœŸå®žç­”æ¡ˆ ($X_{tar}$)ã€‚ä½†æˆ‘ä»¬ä¸èƒ½ç›´æŽ¥æŠŠç­”æ¡ˆç»™æ¨¡åž‹ï¼Œé‚£å®ƒå°±å­¦ä¸åˆ°ä¸œè¥¿äº†ã€‚æ€Žä¹ˆåŠžå‘¢ï¼Ÿæˆ‘ä»¬æŠŠå®ƒè‡ªå·±æ ¹æ®åŽ†å²æ•°æ® ($X_{obs}$) åšçš„â€œè‰ç¨¿â€ï¼Œå’Œä¸€å°éƒ¨åˆ†â€œçœŸå®žç­”æ¡ˆâ€**éšæœºåœ°æ··åˆåœ¨ä¸€èµ·**ã€‚

* **å…¬å¼è§£è¯»ï¼š
$$
z_{mix}=m^k\odot\mathcal{F}(X_{obs})+(1-m^k)\odot X_{tar}^0
$$

  *   $z_{mix}$ï¼šè¿™å°±æ˜¯æœ€ç»ˆæ··åˆç»™æ¨¡åž‹çš„â€œåŠå¼€å·è€ƒå·â€ã€‚
  *   $\mathcal{F}(X_{obs})$ï¼šå·ç§¯ç½‘è·¯æŠŠåŽ†å²æ•°æ® ($X_{obs}$) æ˜ å°„åˆ°çœŸå®žç­”æ¡ˆ ($X_{tar}$)çš„ç›¸åŒç»´åº¦ï¼ˆå¯ä»¥ç†è§£ä¸ºå®ƒçš„â€œè‰ç¨¿â€ï¼‰ã€‚
  *   $X_{tar}$ï¼šæœªæ¥çš„çœŸå®žæ•°æ®ï¼ˆâ€œæ ‡å‡†ç­”æ¡ˆâ€ï¼‰ã€‚
  *   $m^k$ï¼šä¸€ä¸ªéšæœºé¢å…·ï¼ˆmaskï¼‰ï¼Œç”±ä¸€å †0å’Œ1ç»„æˆã€‚
  *   $âŠ™$ï¼šè¿™ä¸ªç¬¦å·ä»£è¡¨â€œé€ç‚¹ç›¸ä¹˜â€ã€‚

  ä½ å¯ä»¥æƒ³è±¡ $m^k$ åƒä¸ªç­›å­ã€‚å½“ $m^k$ çš„æŸä¸ªä½ç½®æ˜¯1æ—¶ï¼Œæˆ‘ä»¬å°±ä¿ç•™æ¨¡åž‹è‡ªå·±çš„ï¼›å½“å®ƒæ˜¯0æ—¶ï¼Œæˆ‘ä»¬å°±æŠŠé‚£ä¸ªä½ç½®æ¢æˆçœŸå®žç­”æ¡ˆã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ¨¡åž‹åœ¨è®­ç»ƒæ—¶æ—¢èƒ½çœ‹åˆ°è‡ªå·±é¢„æµ‹çš„ä¸è¶³ï¼Œåˆèƒ½â€œå·çª¥â€åˆ°ä¸€ç‚¹ç‚¹çœŸå®žæœªæ¥çš„æ ·å­ï¼Œä»Žè€Œå­¦ä¼šç”Ÿæˆæ›´â€œé€¼çœŸâ€ã€æ›´â€œå’Œè°â€çš„æœªæ¥åºåˆ—ã€‚

* **æ‰¹åˆ¤æ€§æ€è€ƒ**ï¼šè¿™çœŸçš„æ˜¯ä¸ªå¥½ä¸»æ„å—ï¼Ÿè¿™ç§â€œå‰§é€â€ä¼šä¸ä¼šè®©æ¨¡åž‹äº§ç”Ÿæƒ°æ€§ï¼Œè¿‡åº¦ä¾èµ–äºŽæˆ‘ä»¬å–‚ç»™å®ƒçš„çœŸå®žæ•°æ®ç‰‡æ®µï¼Œè€Œåœ¨çœŸå®žé¢„æµ‹ï¼ˆå®Œå…¨æ²¡æœ‰æœªæ¥ä¿¡æ¯ï¼‰æ—¶è¡¨çŽ°ä¸ä½³ï¼Ÿè¿™æ˜¯ä¸€ç§â€œæ‹”è‹—åŠ©é•¿â€å—ï¼Ÿè®ºæ–‡çš„æ¶ˆèžå®žéªŒï¼ˆAblation Studyï¼‰ä¼¼ä¹Žè¡¨æ˜Žè¿™ä¸ªæœºåˆ¶æœ‰æ•ˆï¼Œä½†æˆ‘ä»¬å¿…é¡»ä¿æŒè­¦æƒ•ï¼šå®ƒåœ¨æ›´å¤æ‚ã€æ›´é•¿æœŸçš„é¢„æµ‹ä»»åŠ¡ä¸­æ˜¯å¦ä¾ç„¶ç¨³å¥ï¼Ÿ

#### 2. è‡ªå›žå½’åˆå§‹åŒ– (Autoregressive Initialization)

*   **ç›´è§‚ç†è§£**ï¼šæ—¢ç„¶æ¨¡åž‹â€œä¸€æ¬¡æ€§â€ç”Ÿæˆé¢„æµ‹æ—¶ï¼Œç¬¬ä¸€ç¨¿æ‰“å¾—ä¸å¥½ï¼ˆä¸å’Œè°ï¼‰ï¼Œé‚£æˆ‘ä»¬å°±å…ˆç”¨ä¸€ä¸ªéžå¸¸ç®€å•ã€éžå¸¸å¤è€çš„æ–¹æ³•ï¼ˆçº¿æ€§è‡ªå›žå½’æ¨¡åž‹ï¼‰ç»™å®ƒæ‰“ä¸ª**ç²—ç³™çš„è‰ç¨¿** ($z_{ar}$)ã€‚è¿™ä¸ªè‰ç¨¿å¯èƒ½ä¸å‡†ï¼Œæ¯”å¦‚æ— æ³•æ•æ‰å¤æ‚çš„éžçº¿æ€§è¶‹åŠ¿ï¼Œä½†å®ƒè‡³å°‘ä¿è¯äº†æ—¶é—´ä¸Šçš„åŸºæœ¬è¿žè´¯æ€§ï¼Œå°±åƒä¸€ä¸ªç®€å•çš„â€œéª¨æž¶â€ã€‚

*   **å…¬å¼è§£è¯»**ï¼š
$$
z_{ar}=\sum_{t=-H}^0W_t\odot\bar{X}_t+B
$$
* è¿™ä¸ªå…¬å¼æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç®€å•çš„çº¿æ€§æ¨¡åž‹ã€‚å®ƒè®¤ä¸ºæœªæ¥çš„æŸä¸ªç‚¹ï¼Œæ˜¯è¿‡åŽ»æ‰€æœ‰åŽ†å²æ•°æ®ç‚¹ ($X_t$) çš„åŠ æƒå’Œ ($W_t$) å†åŠ ä¸Šä¸€ä¸ªåç½® ($B$)ã€‚è¿™æ˜¯ä¸€ç§éžå¸¸ç»å…¸çš„ç»Ÿè®¡å­¦æ€æƒ³ã€‚

*   **æ‰¹åˆ¤æ€§æ€è€ƒ**ï¼šè¿™ä¸ªæƒ³æ³•å¬èµ·æ¥å¾ˆåˆç†ï¼Œå…ˆæœ‰ä¸€ä¸ªâ€œéª¨æž¶â€ï¼Œå†å¾€ä¸Šå¡«â€œè¡€è‚‰â€ã€‚ä½†è¿™ä¹Ÿæš´éœ²äº†ä¸€ä¸ªæ½œåœ¨çš„å¼±ç‚¹ï¼š**æ•´ä¸ªæ¨¡åž‹çš„æœ€ç»ˆè¡¨çŽ°ï¼Œä¼šä¸ä¼šè¢«è¿™ä¸ªè¿‡äºŽç®€å•çš„â€œåˆå§‹è‰ç¨¿â€ç»™é™åˆ¶ä½ï¼Ÿ** å¦‚æžœåˆå§‹çš„çº¿æ€§æ¨¡åž‹ç»™å‡ºçš„æ–¹å‘ä»Žæ ¹æœ¬ä¸Šå°±æ˜¯é”™çš„ï¼Œé‚£ä¹ˆåŽç»­çš„æ‰©æ•£æ¨¡åž‹ï¼ˆdiffusion modelï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¸æ–­ç²¾ä¿®è‰ç¨¿çš„å¼ºå¤§ç”»å¸ˆï¼‰éœ€è¦èŠ±è´¹å¤šå¤§çš„åŠ›æ°”æ‰èƒ½çº æ­£å›žæ¥ï¼Ÿæˆ–è€…ï¼Œå®ƒä¼šä¸ä¼šæ ¹æœ¬æ— æ³•æ‘†è„±è¿™ä¸ªåˆå§‹è‰ç¨¿çš„â€œå¼•åŠ›â€ï¼Ÿ

#### æ•´ä½“æµç¨‹ä¸Žè¯„ä»·

TimeDiff çš„åšæ³•æ˜¯ï¼ŒæŠŠä¸Šé¢ä¸¤ä¸ªâ€œå°èŠ±æ‹›â€äº§ç”Ÿçš„ç»“æžœ ($z_{mix}$ å’Œ $z_{ar}$) æ‹¼æŽ¥åœ¨ä¸€èµ·ï¼Œä½œä¸ºæ‰©æ•£æ¨¡åž‹çš„åˆå§‹è¾“å…¥ï¼Œç„¶åŽè®©æ¨¡åž‹åŽ»å­¦ä¹ å¦‚ä½•ä»Žè¿™ä¸ªåˆå§‹çŠ¶æ€ï¼Œé€šè¿‡ä¸€ä¸ªåŽ»å™ªè¿‡ç¨‹ï¼Œè¿˜åŽŸå‡ºçœŸå®žçš„æœªæ¥æ•°æ®ã€‚

ä»Žå®žéªŒç»“æžœï¼ˆTable 11ï¼‰æ¥çœ‹ï¼ŒTimeDiff åœ¨å¤šä¸ªæ•°æ®é›†ä¸Šç¡®å®žå–å¾—äº†å½“æ—¶æœ€å¥½çš„ï¼ˆstate-of-the-artï¼‰æ•ˆæžœï¼ŒMSEï¼ˆå‡æ–¹è¯¯å·®ï¼Œè¶Šå°è¶Šå¥½ï¼‰å…¨é¢ä½ŽäºŽå…¶ä»–æ¨¡åž‹ã€‚è¿™è¯æ˜Žäº†å®ƒçš„æœ‰æ•ˆæ€§ã€‚

**ä½†æ˜¯ï¼Œæˆ‘ä»¬å¿…é¡»å‘å‰çœ‹ï¼š**

1.  **æ¨¡åž‹çš„å¤æ‚æ€§**ï¼šè¿™ä¸ªæ¨¡åž‹å¼•å…¥äº†é¢å¤–çš„æ¨¡å—å’Œæ­¥éª¤ï¼Œå®ƒçœŸçš„æ¯”æ›´ç®€æ´çš„æ¨¡åž‹å¥½å—ï¼Ÿæˆ‘ä»¬æ˜¯å¦ä¸ºäº†è¿½æ±‚ä¸€ç‚¹ç‚¹ç²¾åº¦çš„æå‡ï¼Œè€Œç‰ºç‰²äº†å¤ªå¤šæ¨¡åž‹çš„å¯è§£é‡Šæ€§å’Œéƒ¨ç½²æ•ˆçŽ‡ï¼Ÿ
2.  **ä¾èµ–çš„å±€é™**ï¼šè®ºæ–‡è‡ªå·±ä¹Ÿæ‰¿è®¤ï¼Œå®ƒåœ¨æ•æ‰å¤šå˜é‡ä¹‹é—´çš„å¤æ‚ä¾èµ–å…³ç³»æ–¹é¢ä»ç„¶æœ‰å›°éš¾ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æžœä½ çš„æ—¶é—´åºåˆ—æ•°æ®ï¼ˆæ¯”å¦‚è‚¡ç¥¨å¸‚åœºï¼‰ä¸­ï¼Œå„ä¸ªæŒ‡æ ‡ä¹‹é—´å­˜åœ¨å¤æ‚çš„ã€éžçº¿æ€§çš„ç›¸äº’å½±å“ï¼ŒTimeDiff å¯èƒ½ä¾ç„¶ä¼šåŠ›ä¸ä»Žå¿ƒã€‚
3.  **æœªæ¥çš„æ–¹å‘**ï¼šè¿™ç¯‡è®ºæ–‡å‘è¡¨äºŽ2023å¹´ã€‚åœ¨é£žé€Ÿå‘å±•çš„AIé¢†åŸŸï¼Œä¸€å¹´å°±æ˜¯ä¸€ä»£ã€‚çŽ°åœ¨ï¼Œæˆ‘ä»¬æœ‰äº†æ›´å¼ºå¤§çš„åŸºç¡€æ¨¡åž‹ï¼ˆæ¯”å¦‚å¤§åž‹è¯­è¨€æ¨¡åž‹ï¼‰ã€‚æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æ¢ä¸ªæ€è·¯ï¼Ÿ**æˆ‘ä»¬èƒ½å¦å°†æ—¶é—´åºåˆ—æ•°æ®â€œç¿»è¯‘â€æˆä¸€ç§è¯­è¨€ï¼Œç„¶åŽè®©è¯­è¨€æ¨¡åž‹åŽ»â€œç»­å†™â€æœªæ¥ï¼Ÿ** è¿™ç§æ€è·¯å¯èƒ½ä¼šå½»åº•é¢ è¦†åƒTimeDiffè¿™æ ·çš„ä¸“ç”¨æ¨¡åž‹æ¡†æž¶ã€‚

æ€»è€Œè¨€ä¹‹ï¼ŒTimeDiff æ˜¯ä¸€ç¯‡éžå¸¸æ‰Žå®žçš„è®ºæ–‡ï¼Œå®ƒå·§å¦™åœ°ç»“åˆäº†ç»å…¸æ–¹æ³•å’Œæ–°æ½®æ€æƒ³ï¼Œè§£å†³äº†å½“æ—¶éžè‡ªå›žå½’æ¨¡åž‹çš„ä¸€ä¸ªæ ¸å¿ƒç—›ç‚¹ã€‚å¯¹äºŽä½ æ¥è¯´ï¼Œå®ƒæ˜¯ä¸€ä¸ªç»ä½³çš„å­¦ä¹ æ¡ˆä¾‹ï¼Œå¯ä»¥å¸®åŠ©ä½ ç†è§£ï¼š

*   ç ”ç©¶è€…æ˜¯å¦‚ä½•è¯†åˆ«å‡ºé—®é¢˜çš„ï¼ˆdisharmonyï¼‰ã€‚
*   ä»–ä»¬æ˜¯å¦‚ä½•â€œè„‘æ´žå¤§å¼€â€åœ°è®¾è®¡è§£å†³æ–¹æ¡ˆçš„ï¼ˆmixup & initializationï¼‰ã€‚
*   ä»–ä»¬æ˜¯å¦‚ä½•é€šè¿‡å®žéªŒæ¥éªŒè¯è‡ªå·±æƒ³æ³•çš„ã€‚
### 2.3.10 TSDiff
#### ä¸¤ç§ä¸åŒçš„â€œè‡ªæˆ‘å¼•å¯¼â€ç­–ç•¥

è®ºæ–‡æå‡ºäº†ä¸¤ç§å…·ä½“çš„â€œè‡ªæˆ‘å¼•å¯¼â€æ–¹æ³•ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨äºŽâ€œå®¡è§†â€å’Œâ€œä¿®æ­£â€çš„æ ‡å‡†ä¸åŒã€‚

1. **å‡æ–¹è¯¯å·®è‡ªæˆ‘å¼•å¯¼ (Mean Square Self-Guidance, TSDiff-MS)**

*   **ç›´è§‚ç†è§£**ï¼šè¿™æ˜¯ä¸€ç§æœ€ç›´æŽ¥çš„å¼•å¯¼æ–¹å¼ã€‚å®ƒåœ¨æ¯ä¸€æ­¥éƒ½é—®ï¼šâ€œæˆ‘çŽ°åœ¨çš„â€˜åŠæˆå“â€™é¢„æµ‹ï¼Œå’ŒçœŸå®žçš„åŽ†å²æ•°æ®ï¼Œåœ¨æ•°å€¼ä¸Šæœ‰å¤šæŽ¥è¿‘ï¼Ÿâ€ å®ƒä½¿ç”¨çš„è¯„åˆ¤æ ‡å‡†æ˜¯**å‡æ–¹è¯¯å·®ï¼ˆMSEï¼‰**ï¼Œä¹Ÿå°±æ˜¯è®¡ç®—é¢„æµ‹å€¼å’ŒçœŸå®žå€¼ä¹‹å·®çš„å¹³æ–¹ã€‚
*   **å…¬å¼è§£è¯»**ï¼šè¿™ä¸ªå¼•å¯¼çš„å…³é”®åœ¨äºŽå¦‚ä½•ä»Žä¸€ä¸ªå……æ»¡å™ªå£°çš„â€œåŠæˆå“â€ $x_{tar}^k$ ä¸­ï¼Œä¼°ç®—å‡ºå®ƒå¯¹åº”çš„â€œæ¸…æ™°ç‰ˆâ€é¢„æµ‹ $f_{\theta}(x_{tar}^k, k)$ã€‚
    $$
    f_{\theta}(x_{tar}^k, k) = \frac{x_{tar}^k - \sqrt{1 - \bar{\alpha}_k} \epsilon_{\theta}(x_{tar}^k, k)}{\sqrt{\bar{\alpha}_k}}
    $$
    *   $x_{tar}^k$ï¼šåœ¨åŽ»å™ªæ­¥éª¤ $k$ æ—¶ï¼Œé‚£ä¸ªæ—¢åŒ…å«çœŸå®žä¿¡å·åˆåŒ…å«å™ªå£°çš„â€œåŠæˆå“â€ã€‚
    *   $\epsilon_{\theta}(x_{tar}^k, k)$ï¼šæ¨¡åž‹ $\theta$ çš„æ ¸å¿ƒå·¥ä½œï¼Œå³é¢„æµ‹åœ¨ $x_{tar}^k$ ä¸­åŒ…å«äº†å¤šå°‘å™ªå£°ã€‚
    *   $\bar{\alpha}_k$ï¼šä¸€ä¸ªé¢„å…ˆè®¾å®šçš„ã€åœ¨æ‰©æ•£è¿‡ç¨‹ä¸­é€æ¸å˜åŒ–çš„å‚æ•°ï¼Œä»£è¡¨äº†ä¿¡å·çš„ä¿ç•™ç¨‹åº¦ã€‚
    *   $f_{\theta}(...)$ï¼šæ•´ä¸ªå…¬å¼å°±æ˜¯é€šè¿‡å½“å‰çš„â€œåŠæˆå“â€å‡åŽ»æ¨¡åž‹é¢„æµ‹çš„â€œå™ªå£°â€ï¼Œä»Žè€Œè¿˜åŽŸå‡ºå¯¹â€œæ¸…æ™°ç‰ˆâ€é¢„æµ‹çš„ä¸€ä¸ªä¼°è®¡ã€‚
    ç„¶åŽï¼Œé€šè¿‡æœ€å°åŒ–è¿™ä¸ªä¼°è®¡å€¼å’ŒçœŸå®žåŽ†å²æ•°æ®ä¹‹é—´çš„å‡æ–¹è¯¯å·®ï¼Œæ¥å¼•å¯¼æ•´ä¸ªç”Ÿæˆè¿‡ç¨‹ã€‚

*   **æ‰¹åˆ¤æ€§æ€è€ƒ**ï¼šè¿™ç§æ–¹æ³•åªå…³å¿ƒâ€œå‡å€¼â€çš„å¯¹é½ï¼Œå®ƒèƒ½ç¡®ä¿é¢„æµ‹çš„ä¸­å¿ƒè¶‹åŠ¿æ˜¯å‡†ç¡®çš„ã€‚ä½†å¯¹äºŽæ¦‚çŽ‡æ€§é¢„æµ‹æ¥è¯´ï¼Œæˆ‘ä»¬ä¸ä»…å…³å¿ƒä¸­å¿ƒï¼Œæ›´å…³å¿ƒ**èŒƒå›´çš„å®½åº¦**ã€‚å¦‚æžœæ¨¡åž‹åªå­¦ä¼šäº†é¢„æµ‹å‡å€¼ï¼Œå®ƒç»™å‡ºçš„ä¸ç¡®å®šæ€§èŒƒå›´å¯èƒ½ä¼šè¿‡äºŽè‡ªä¿¡ï¼ˆå¤ªçª„ï¼‰æˆ–è¿‡äºŽä¿å®ˆï¼ˆå¤ªå®½ï¼‰ï¼Œè¿™åœ¨é£Žé™©è¯„ä¼°ä¸­æ˜¯è‡´å‘½çš„ã€‚

2. **åˆ†ä½æ•°è‡ªæˆ‘å¼•å¯¼ (Quantile Self-Guidance, TSDiff-Q)**

*   **ç›´è§‚ç†è§£**ï¼šè¿™æ˜¯ä¸€ç§æ›´é«˜çº§çš„å¼•å¯¼æ–¹å¼ã€‚å®ƒä¸å†åªç›¯ç€â€œå‡å€¼â€é‚£ä¸€ä¸ªç‚¹ï¼Œè€Œæ˜¯åŒæ—¶å…³æ³¨æ•´ä¸ªé¢„æµ‹èŒƒå›´çš„å¤šä¸ªå…³é”®ä½ç½®ï¼Œæ¯”å¦‚â€œ10%çš„å¯èƒ½æ€§ä¸‹ï¼Œæœ€åçš„æƒ…å†µæ˜¯ä»€ä¹ˆï¼Ÿâ€ï¼ˆç¬¬10åˆ†ä½æ•°ï¼‰ã€â€œ90%çš„å¯èƒ½æ€§ä¸‹ï¼Œæœ€å¥½çš„æƒ…å†µæ˜¯ä»€ä¹ˆï¼Ÿâ€ï¼ˆç¬¬90åˆ†ä½æ•°ï¼‰ã€‚å®ƒé€šè¿‡ä¸€ç§å«åš**åˆ†ä½æ•°æŸå¤±ï¼ˆQuantile Lossï¼‰çš„å‡½æ•°æ¥åŒæ—¶ä¼˜åŒ–æ‰€æœ‰è¿™äº›ç‚¹ï¼Œç¡®ä¿æ•´ä¸ªé¢„æµ‹**åˆ†å¸ƒéƒ½å°½å¯èƒ½å‡†ç¡®ã€‚
*   **å…¬å¼è§£è¯»**ï¼š
    $$
    \mathcal{L}_{quantile} = \max\{ \kappa \cdot (x_{obs} - f_{\theta}(x_{tar}^k, k)), (\kappa - 1) \cdot (x_{obs} - f_{\theta}(x_{tar}^k, k)) \}
    $$
    *   $\kappa$ (kappa)ï¼šè¿™å°±æ˜¯**åˆ†ä½æ•°æ°´å¹³**ï¼Œä¸€ä¸ªåœ¨0å’Œ1ä¹‹é—´çš„æ•°ã€‚æ¯”å¦‚ï¼Œå½“ $\kappa=0.1$ æ—¶ï¼Œè¿™ä¸ªæŸå¤±å‡½æ•°å°±ä¼šæƒ©ç½šé‚£äº›å¯¹â€œ10%æœ€åæƒ…å†µâ€é¢„æµ‹ä¸å‡†çš„æ¨¡åž‹ã€‚å½“ $\kappa=0.9$ æ—¶ï¼Œå°±ä¼šæƒ©ç½šå¯¹â€œ90%æœ€å¥½æƒ…å†µâ€é¢„æµ‹ä¸å‡†çš„æ¨¡åž‹ã€‚
    *   è¿™ä¸ª $max$ å‡½æ•°çš„ä½œç”¨æ˜¯ï¼šå¦‚æžœä½ æ›´å…³å¿ƒé¢„æµ‹çš„â€œæžç«¯ä½Žå€¼â€ï¼Œå°±è®© $\kappa$ å–å¾ˆå°ï¼›å…³å¿ƒâ€œæžç«¯é«˜å€¼â€ï¼Œå°±è®© $\kappa$ å–å¾ˆå¤§ã€‚è¿™ç§ä¸å¯¹ç§°çš„æƒ©ç½šæ­£æ˜¯åˆ†ä½æ•°æŸå¤±çš„ç²¾é«“ï¼Œå®ƒè¿«ä½¿æ¨¡åž‹åŽ»å­¦ä¹ æ•´ä¸ªåˆ†å¸ƒçš„å½¢çŠ¶ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸­å¿ƒç‚¹ã€‚

*   **æ‰¹åˆ¤æ€§æ€è€ƒ**ï¼šè¿™æ— ç–‘æ˜¯ä¸€ä¸ªæ›´ç²¾ç»†ã€æ›´å¼ºå¤§çš„æ–¹æ³•ï¼Œå®žéªŒç»“æžœï¼ˆTable 12ï¼‰ä¹Ÿè¯æ˜Žäº†è¿™ä¸€ç‚¹ï¼ˆTSDiff-Qåœ¨å¤šæ•°æ•°æ®é›†ä¸Šæ•ˆæžœæœ€å¥½ï¼ŒCRPSæŒ‡æ ‡è¶Šå°è¶Šå¥½ï¼‰ã€‚ä½†å®ƒæ˜¯å¦å¼•å…¥äº†è¿‡å¤šçš„è¶…å‚æ•°ï¼ˆæ¯”å¦‚è¦é€‰å¤šå°‘ä¸ªåˆ†ä½æ•°ã€é€‰å“ªäº›åˆ†ä½æ•°ï¼‰ï¼Ÿè¿™ç§å¼•å¯¼ä¼šä¸ä¼šè®©æ¨¡åž‹åœ¨æŸäº›åˆ†ä½æ•°ä¸Šè¡¨çŽ°å¾ˆå¥½ï¼Œå´åœ¨å¦ä¸€äº›æœªè¢«æ˜¾å¼ä¼˜åŒ–çš„åˆ†ä½æ•°ä¸Šè¡¨çŽ°å¾ˆå·®ï¼Ÿ

#### ç»“è®ºä¸Žå‰çž»

è¿™ç¯‡è®ºæ–‡çš„æ ¸å¿ƒè´¡çŒ®åœ¨äºŽæå‡ºäº†**Self-Guidance**è¿™ä¸ªä¼˜é›…ä¸”æœ‰æ•ˆçš„æ¡†æž¶ï¼Œè®©æ‰©æ•£æ¨¡åž‹åœ¨ä¸éœ€è¦é¢å¤–ç»„ä»¶çš„æƒ…å†µä¸‹ï¼Œå°±èƒ½è¿›è¡Œé«˜è´¨é‡çš„æ¦‚çŽ‡æ€§æ—¶é—´åºåˆ—é¢„æµ‹ã€‚

**ä½†æˆ‘ä»¬ä»éœ€ä¿æŒæ€€ç–‘å’Œå‰çž»çš„è§†è§’ï¼š**

1.  **å•å˜é‡çš„å±€é™**ï¼šè®ºæ–‡ä¸»è¦åœ¨å•å˜é‡ï¼ˆunivariateï¼‰æ•°æ®ä¸Šè¿›è¡Œå®žéªŒã€‚ç„¶è€Œï¼ŒçœŸå®žä¸–ç•Œçš„æ—¶é—´åºåˆ—ï¼ˆå¦‚ç»æµŽã€äº¤é€šï¼‰å¾€å¾€æ˜¯å¤šå˜é‡ï¼ˆmultivariateï¼‰ä¸”ç›¸äº’å½±å“çš„ã€‚å°†è¿™ç§æ–¹æ³•æ‰©å±•åˆ°å¤šå˜é‡åœºæ™¯ï¼Œæ˜¯å¦è¿˜èƒ½ä¿æŒå…¶ä¼˜é›…å’Œé«˜æ•ˆï¼Ÿè®ºæ–‡ä¸­æåˆ°äº†ä¸€äº›æ€è·¯ï¼Œä½†è¿™ä»æ˜¯ä¸€ä¸ªå·¨å¤§çš„æŒ‘æˆ˜ã€‚
2.  **æ•ˆçŽ‡é—®é¢˜**ï¼šæ‰©æ•£æ¨¡åž‹ä¸ºäº†ç”Ÿæˆé«˜è´¨é‡çš„æ ·æœ¬ï¼Œé€šå¸¸éœ€è¦å¾ˆå¤šæ­¥çš„è¿­ä»£ï¼ˆåŽ»å™ªï¼‰ï¼Œè¿™ä½¿å¾—å®ƒä»¬çš„æŽ¨ç†é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ã€‚è™½ç„¶æ¯”éœ€è¦è®­ç»ƒé¢å¤–æ¨¡åž‹çš„å¼•å¯¼æ–¹æ³•è¦å¥½ï¼Œä½†åœ¨éœ€è¦å®žæ—¶é¢„æµ‹çš„åœºæ™¯ä¸‹ï¼Œè¿™ä»ç„¶æ˜¯ä¸€ä¸ªç“¶é¢ˆã€‚
3.  **æœªæ¥çš„èžåˆ**ï¼šæˆ‘ä»¬å†æ¬¡å›žåˆ°é‚£ä¸ªé—®é¢˜ï¼šå½“å¤§åž‹è¯­è¨€æ¨¡åž‹ï¼ˆLLMsï¼‰å±•çŽ°å‡ºå¼ºå¤§çš„åºåˆ—å»ºæ¨¡èƒ½åŠ›æ—¶ï¼Œæˆ‘ä»¬æ˜¯å¦åº”è¯¥è€ƒè™‘å°†è¿™ç§ç²¾ç»†çš„â€œæ¦‚çŽ‡å¼•å¯¼â€æ€æƒ³ï¼Œä¸ŽLLMçš„â€œå¸¸è¯†æŽ¨ç†â€å’Œâ€œä¸Šä¸‹æ–‡ç†è§£â€èƒ½åŠ›ç»“åˆèµ·æ¥ï¼Ÿä¹Ÿè®¸æœªæ¥çš„æ¨¡åž‹ï¼Œæ—¢èƒ½åƒTSDiffä¸€æ ·ç»™å‡ºç²¾ç¡®çš„æ¦‚çŽ‡åˆ†å¸ƒï¼Œåˆèƒ½åƒLLMä¸€æ ·ç†è§£äº‹ä»¶çš„å› æžœå…³ç³»ï¼ˆæ¯”å¦‚â€œå› ä¸ºèŠ‚å‡æ—¥ï¼Œæ‰€ä»¥äº¤é€šæµé‡ä¼šå¼‚å¸¸å¢žé«˜â€ï¼‰ã€‚

## 3 NsDiff
Non-stationary Diffusion For Probabilistic Time Series Forecasting
### 3.2 å®žéªŒ

> [!QUESTIONS] 
> To estimate uncertainty variation between the train and test datasets, we use the ratio of test variance to train variance, selecting the highest value across dimensions to capture non-stationary uncertainty.
> ä»€ä¹ˆæ˜¯æµ‹è¯•æ–¹å·®å’Œè®­ç»ƒæ–¹å·®çš„æ¯”çŽ‡ï¼Ÿ
